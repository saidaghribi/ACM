"use strict";(self.webpackChunkacm_web=self.webpackChunkacm_web||[]).push([[967,519],{36949:function(e,t,n){n.d(t,{NU:function(){return he},q4:function(){return ge}});var i=n(37716),o=n(17238),l=n(38583),r=n(11818),a=n(16988),s=n(33013),d=n(3679),c=n(71386),u=n(99287),p=n(19309);function m(e,t){if(1&e&&(i.\u0275\u0275elementStart(0,"span"),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),2&e){const e=i.\u0275\u0275nextContext();i.\u0275\u0275advance(1),i.\u0275\u0275textInterpolate(e.label)}}function f(e,t){1&e&&i.\u0275\u0275elementContainer(0)}const h=function(e){return{height:e}},g=function(e,t){return{"p-highlight":e,"p-disabled":t}},v=function(e){return{"p-highlight":e}},y=function(e){return{"pi pi-check":e}},S=function(e){return{$implicit:e}},x=["container"],C=["filterInput"],b=["in"];function E(e,t){if(1&e&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275text(1),i.\u0275\u0275elementContainerEnd()),2&e){const e=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(1),i.\u0275\u0275textInterpolate(e.valuesAsString||"empty")}}function I(e,t){if(1&e){const e=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"span",17),i.\u0275\u0275listener("click",function(t){i.\u0275\u0275restoreView(e);const n=i.\u0275\u0275nextContext().$implicit;return i.\u0275\u0275nextContext(3).removeChip(n,t)}),i.\u0275\u0275elementEnd()}}function L(e,t){if(1&e&&(i.\u0275\u0275elementStart(0,"div",13,14),i.\u0275\u0275elementStart(2,"span",15),i.\u0275\u0275text(3),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(4,I,1,0,"span",16),i.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=i.\u0275\u0275nextContext(3);i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(n.findLabelByValue(e)),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",!n.disabled)}}function F(e,t){if(1&e&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275text(1),i.\u0275\u0275elementContainerEnd()),2&e){const e=i.\u0275\u0275nextContext(3);i.\u0275\u0275advance(1),i.\u0275\u0275textInterpolate(e.placeholder||e.defaultLabel||"empty")}}function D(e,t){if(1&e&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275template(1,L,5,2,"div",12),i.\u0275\u0275template(2,F,2,1,"ng-container",7),i.\u0275\u0275elementContainerEnd()),2&e){const e=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(1),i.\u0275\u0275property("ngForOf",e.value),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",!e.value||0===e.value.length)}}function T(e,t){if(1&e&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275template(1,E,2,1,"ng-container",7),i.\u0275\u0275template(2,D,3,2,"ng-container",7),i.\u0275\u0275elementContainerEnd()),2&e){const e=i.\u0275\u0275nextContext();i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf","comma"===e.display),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf","chip"===e.display)}}function w(e,t){1&e&&i.\u0275\u0275elementContainer(0)}function O(e,t){1&e&&i.\u0275\u0275elementContainer(0)}const k=function(e){return{"p-checkbox-disabled":e}},G=function(e,t,n){return{"p-highlight":e,"p-focus":t,"p-disabled":n}};function R(e,t){if(1&e){const e=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",30),i.\u0275\u0275elementStart(1,"div",2),i.\u0275\u0275elementStart(2,"input",31),i.\u0275\u0275listener("focus",function(){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext(3).onHeaderCheckboxFocus()})("blur",function(){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext(3).onHeaderCheckboxBlur()})("keydown.space",function(t){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext(3).toggleAll(t)}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(3,"div",32),i.\u0275\u0275listener("click",function(t){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext(3).toggleAll(t)}),i.\u0275\u0275element(4,"span",33),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementEnd()}if(2&e){const e=i.\u0275\u0275nextContext(3);i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(6,k,e.disabled||e.toggleAllDisabled)),i.\u0275\u0275advance(2),i.\u0275\u0275property("checked",e.allChecked)("disabled",e.disabled||e.toggleAllDisabled),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction3(8,G,e.allChecked,e.headerCheckboxFocus,e.disabled||e.toggleAllDisabled)),i.\u0275\u0275attribute("aria-checked",e.allChecked),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(12,y,e.allChecked))}}function _(e,t){if(1&e){const e=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",34),i.\u0275\u0275elementStart(1,"input",35,36),i.\u0275\u0275listener("input",function(t){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext(3).onFilterInputChange(t)}),i.\u0275\u0275elementEnd(),i.\u0275\u0275element(3,"span",37),i.\u0275\u0275elementEnd()}if(2&e){const e=i.\u0275\u0275nextContext(3);i.\u0275\u0275advance(1),i.\u0275\u0275property("value",e.filterValue||"")("disabled",e.disabled),i.\u0275\u0275attribute("placeholder",e.filterPlaceHolder)("aria-label",e.ariaFilterLabel)}}function A(e,t){if(1&e){const e=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",24),i.\u0275\u0275projection(1),i.\u0275\u0275template(2,O,1,0,"ng-container",25),i.\u0275\u0275template(3,R,5,14,"div",26),i.\u0275\u0275template(4,_,4,4,"div",27),i.\u0275\u0275elementStart(5,"button",28),i.\u0275\u0275listener("click",function(t){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext(2).close(t)}),i.\u0275\u0275element(6,"span",29),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementEnd()}if(2&e){const e=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(2),i.\u0275\u0275property("ngTemplateOutlet",e.headerTemplate),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",e.showToggleAll&&!e.selectionLimit),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",e.filter)}}function V(e,t){if(1&e&&(i.\u0275\u0275elementStart(0,"span"),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),2&e){const e=i.\u0275\u0275nextContext().$implicit,t=i.\u0275\u0275nextContext(3);i.\u0275\u0275advance(1),i.\u0275\u0275textInterpolate(t.getOptionGroupLabel(e)||"empty")}}function N(e,t){1&e&&i.\u0275\u0275elementContainer(0)}function U(e,t){1&e&&i.\u0275\u0275elementContainer(0)}function M(e,t){if(1&e&&(i.\u0275\u0275elementStart(0,"li",39),i.\u0275\u0275template(1,V,2,1,"span",7),i.\u0275\u0275template(2,N,1,0,"ng-container",8),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(3,U,1,0,"ng-container",8)),2&e){const e=t.$implicit;i.\u0275\u0275nextContext(2);const n=i.\u0275\u0275reference(7),o=i.\u0275\u0275nextContext();i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",!o.groupTemplate),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngTemplateOutlet",o.groupTemplate)("ngTemplateOutletContext",i.\u0275\u0275pureFunction1(5,S,e)),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngTemplateOutlet",n)("ngTemplateOutletContext",i.\u0275\u0275pureFunction1(7,S,o.getOptionGroupChildren(e)))}}function B(e,t){if(1&e&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275template(1,M,4,9,"ng-template",38),i.\u0275\u0275elementContainerEnd()),2&e){const e=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(1),i.\u0275\u0275property("ngForOf",e.optionsToRender)}}function P(e,t){1&e&&i.\u0275\u0275elementContainer(0)}function j(e,t){if(1&e&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275template(1,P,1,0,"ng-container",8),i.\u0275\u0275elementContainerEnd()),2&e){i.\u0275\u0275nextContext();const e=i.\u0275\u0275reference(7),t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(1),i.\u0275\u0275property("ngTemplateOutlet",e)("ngTemplateOutletContext",i.\u0275\u0275pureFunction1(2,S,t.optionsToRender))}}function J(e,t){if(1&e){const e=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"p-multiSelectItem",43),i.\u0275\u0275listener("onClick",function(t){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext(4).onOptionClick(t)})("onKeydown",function(t){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext(4).onOptionKeydown(t)}),i.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=i.\u0275\u0275nextContext(4);i.\u0275\u0275property("option",e)("selected",n.isSelected(e))("label",n.getOptionLabel(e))("disabled",n.isOptionDisabled(e))("template",n.itemTemplate)}}function z(e,t){if(1&e&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275template(1,J,1,5,"ng-template",38),i.\u0275\u0275elementContainerEnd()),2&e){const e=i.\u0275\u0275nextContext().$implicit;i.\u0275\u0275advance(1),i.\u0275\u0275property("ngForOf",e)}}function q(e,t){if(1&e){const e=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275elementStart(1,"p-multiSelectItem",48),i.\u0275\u0275listener("onClick",function(t){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext(5).onOptionClick(t)})("onKeydown",function(t){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext(5).onOptionKeydown(t)}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementContainerEnd()}if(2&e){const e=t.$implicit,n=i.\u0275\u0275nextContext(5);i.\u0275\u0275advance(1),i.\u0275\u0275property("option",e)("selected",n.isSelected(e))("label",n.getOptionLabel(e))("disabled",n.isOptionDisabled(e))("template",n.itemTemplate)("itemSize",n.itemSize)}}function H(e,t){if(1&e&&(i.\u0275\u0275elementStart(0,"cdk-virtual-scroll-viewport",45,46),i.\u0275\u0275template(2,q,2,6,"ng-container",47),i.\u0275\u0275elementEnd()),2&e){const e=i.\u0275\u0275nextContext(2).$implicit,t=i.\u0275\u0275nextContext(2);i.\u0275\u0275property("ngStyle",i.\u0275\u0275pureFunction1(3,h,t.scrollHeight))("itemSize",t.itemSize),i.\u0275\u0275advance(2),i.\u0275\u0275property("cdkVirtualForOf",e)}}function Y(e,t){if(1&e&&i.\u0275\u0275template(0,H,3,5,"cdk-virtual-scroll-viewport",44),2&e){const e=i.\u0275\u0275nextContext(3);i.\u0275\u0275property("ngIf",e.virtualScroll&&!e.emptyOptions)}}function W(e,t){if(1&e&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275text(1),i.\u0275\u0275elementContainerEnd()),2&e){const e=i.\u0275\u0275nextContext(4);i.\u0275\u0275advance(1),i.\u0275\u0275textInterpolate1(" ",e.emptyFilterMessageLabel," ")}}function K(e,t){1&e&&i.\u0275\u0275elementContainer(0,null,50)}function $(e,t){if(1&e&&(i.\u0275\u0275elementStart(0,"li",49),i.\u0275\u0275template(1,W,2,1,"ng-container",40),i.\u0275\u0275template(2,K,2,0,"ng-container",25),i.\u0275\u0275elementEnd()),2&e){const e=i.\u0275\u0275nextContext(3);i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",!e.emptyFilterTemplate&&!e.emptyTemplate)("ngIfElse",e.emptyFilter),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngTemplateOutlet",e.emptyFilterTemplate||e.emptyTemplate)}}function Z(e,t){if(1&e&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275text(1),i.\u0275\u0275elementContainerEnd()),2&e){const e=i.\u0275\u0275nextContext(4);i.\u0275\u0275advance(1),i.\u0275\u0275textInterpolate1(" ",e.emptyMessageLabel," ")}}function Q(e,t){1&e&&i.\u0275\u0275elementContainer(0,null,51)}function X(e,t){if(1&e&&(i.\u0275\u0275elementStart(0,"li",49),i.\u0275\u0275template(1,Z,2,1,"ng-container",40),i.\u0275\u0275template(2,Q,2,0,"ng-container",25),i.\u0275\u0275elementEnd()),2&e){const e=i.\u0275\u0275nextContext(3);i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",!e.emptyTemplate)("ngIfElse",e.empty),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngTemplateOutlet",e.emptyTemplate)}}function ee(e,t){if(1&e&&(i.\u0275\u0275template(0,z,2,1,"ng-container",40),i.\u0275\u0275template(1,Y,1,1,"ng-template",null,41,i.\u0275\u0275templateRefExtractor),i.\u0275\u0275template(3,$,3,3,"li",42),i.\u0275\u0275template(4,X,3,3,"li",42)),2&e){const e=i.\u0275\u0275reference(2),t=i.\u0275\u0275nextContext(2);i.\u0275\u0275property("ngIf",!t.virtualScroll)("ngIfElse",e),i.\u0275\u0275advance(3),i.\u0275\u0275property("ngIf",t.hasFilter()&&t.emptyOptions),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",!t.hasFilter()&&t.emptyOptions)}}function te(e,t){1&e&&i.\u0275\u0275elementContainer(0)}function ne(e,t){if(1&e&&(i.\u0275\u0275elementStart(0,"div",52),i.\u0275\u0275projection(1,1),i.\u0275\u0275template(2,te,1,0,"ng-container",25),i.\u0275\u0275elementEnd()),2&e){const e=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(2),i.\u0275\u0275property("ngTemplateOutlet",e.footerTemplate)}}const ie=function(){return["p-multiselect-panel p-component"]},oe=function(e,t){return{showTransitionParams:e,hideTransitionParams:t}},le=function(e){return{value:"visible",params:e}},re=function(e){return{"p-multiselect-virtualscroll":e}};function ae(e,t){if(1&e){const e=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",18),i.\u0275\u0275listener("@overlayAnimation.start",function(t){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext().onOverlayAnimationStart(t)})("@overlayAnimation.done",function(t){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext().onOverlayAnimationEnd(t)})("keydown",function(t){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext().onKeydown(t)})("click",function(t){return i.\u0275\u0275restoreView(e),i.\u0275\u0275nextContext().onOverlayClick(t)}),i.\u0275\u0275template(1,A,7,3,"div",19),i.\u0275\u0275elementStart(2,"div",20),i.\u0275\u0275elementStart(3,"ul",21),i.\u0275\u0275template(4,B,2,1,"ng-container",7),i.\u0275\u0275template(5,j,2,4,"ng-container",7),i.\u0275\u0275template(6,ee,5,4,"ng-template",null,22,i.\u0275\u0275templateRefExtractor),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(8,ne,3,1,"div",23),i.\u0275\u0275elementEnd()}if(2&e){const e=i.\u0275\u0275nextContext();i.\u0275\u0275classMap(e.panelStyleClass),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction0(12,ie))("@overlayAnimation",i.\u0275\u0275pureFunction1(16,le,i.\u0275\u0275pureFunction2(13,oe,e.showTransitionOptions,e.hideTransitionOptions)))("ngStyle",e.panelStyle),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",e.showHeader),i.\u0275\u0275advance(1),i.\u0275\u0275styleProp("max-height",e.virtualScroll?"auto":e.scrollHeight||"auto"),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(18,re,e.virtualScroll)),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",e.group),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",!e.group),i.\u0275\u0275advance(3),i.\u0275\u0275property("ngIf",e.footerFacet||e.footerTemplate)}}const se=[[["p-header"]],[["p-footer"]]],de=function(e,t,n,i){return{"p-multiselect p-component":!0,"p-multiselect-open":e,"p-multiselect-chip":t,"p-focus":n,"p-disabled":i}},ce=function(e,t){return{"p-placeholder":e,"p-multiselect-label-empty":t}},ue=function(){return{"p-multiselect-trigger":!0}},pe=["p-header","p-footer"],me={provide:d.JU,useExisting:(0,i.forwardRef)(()=>he),multi:!0};let fe=(()=>{class e{constructor(){this.onClick=new i.EventEmitter,this.onKeydown=new i.EventEmitter}onOptionClick(e){this.onClick.emit({originalEvent:e,option:this.option})}onOptionKeydown(e){this.onKeydown.emit({originalEvent:e,option:this.option})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.\u0275\u0275defineComponent({type:e,selectors:[["p-multiSelectItem"]],hostAttrs:[1,"p-element"],inputs:{option:"option",selected:"selected",label:"label",disabled:"disabled",itemSize:"itemSize",template:"template"},outputs:{onClick:"onClick",onKeydown:"onKeydown"},decls:6,vars:20,consts:[["pRipple","",1,"p-multiselect-item",3,"ngStyle","ngClass","click","keydown"],[1,"p-checkbox","p-component"],[1,"p-checkbox-box",3,"ngClass"],[1,"p-checkbox-icon",3,"ngClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,t){1&e&&(i.\u0275\u0275elementStart(0,"li",0),i.\u0275\u0275listener("click",function(e){return t.onOptionClick(e)})("keydown",function(e){return t.onOptionKeydown(e)}),i.\u0275\u0275elementStart(1,"div",1),i.\u0275\u0275elementStart(2,"div",2),i.\u0275\u0275element(3,"span",3),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(4,m,2,1,"span",4),i.\u0275\u0275template(5,f,1,0,"ng-container",5),i.\u0275\u0275elementEnd()),2&e&&(i.\u0275\u0275property("ngStyle",i.\u0275\u0275pureFunction1(9,h,t.itemSize+"px"))("ngClass",i.\u0275\u0275pureFunction2(11,g,t.selected,t.disabled)),i.\u0275\u0275attribute("aria-label",t.label)("tabindex",t.disabled?null:"0"),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(14,v,t.selected)),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(16,y,t.selected)),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",!t.template),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngTemplateOutlet",t.template)("ngTemplateOutletContext",i.\u0275\u0275pureFunction1(18,S,t.option)))},directives:[p.H,l.NgStyle,l.NgClass,l.NgIf,l.NgTemplateOutlet],encapsulation:2}),e})(),he=(()=>{class e{constructor(e,t,n,o,l,r){this.el=e,this.renderer=t,this.cd=n,this.filterService=o,this.config=l,this.overlayService=r,this.filter=!0,this.displaySelectedLabel=!0,this.maxSelectedLabels=3,this.selectedItemsLabel="ellipsis",this.showToggleAll=!0,this.emptyFilterMessage="",this.emptyMessage="",this.resetFilterOnHide=!1,this.dropdownIcon="pi pi-chevron-down",this.optionGroupChildren="items",this.showHeader=!0,this.autoZIndex=!0,this.baseZIndex=0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.filterMatchMode="contains",this.tooltip="",this.tooltipPosition="right",this.tooltipPositionStyle="absolute",this.autofocusFilter=!0,this.display="comma",this.onChange=new i.EventEmitter,this.onFilter=new i.EventEmitter,this.onFocus=new i.EventEmitter,this.onBlur=new i.EventEmitter,this.onClick=new i.EventEmitter,this.onPanelShow=new i.EventEmitter,this.onPanelHide=new i.EventEmitter,this.scrollHeight="200px",this.onModelChange=()=>{},this.onModelTouched=()=>{}}set defaultLabel(e){this._defaultLabel=e,this.updateLabel()}get defaultLabel(){return this._defaultLabel}set placeholder(e){this._placeholder=e,this.updateLabel()}get placeholder(){return this._placeholder}get options(){return this._options}set options(e){this._options=e,this.updateLabel()}get filterValue(){return this._filterValue}set filterValue(e){this._filterValue=e,this.activateFilter()}ngOnInit(){this.updateLabel()}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":this.itemTemplate=e.template;break;case"group":this.groupTemplate=e.template;break;case"selectedItems":this.selectedItemsTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"emptyfilter":this.emptyFilterTemplate=e.template;break;case"empty":this.emptyTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;default:this.itemTemplate=e.template}})}ngAfterViewInit(){this.overlayVisible&&this.show()}ngAfterViewChecked(){this.filtered&&(this.alignOverlay(),this.filtered=!1)}getOptionLabel(e){return this.optionLabel?a.gb.resolveFieldData(e,this.optionLabel):null!=e.label?e.label:e}getOptionValue(e){return this.optionValue?a.gb.resolveFieldData(e,this.optionValue):this.optionLabel||void 0===e.value?e:e.value}getOptionGroupLabel(e){return this.optionGroupLabel?a.gb.resolveFieldData(e,this.optionGroupLabel):null!=e.label?e.label:e}getOptionGroupChildren(e){return this.optionGroupChildren?a.gb.resolveFieldData(e,this.optionGroupChildren):e.items}isOptionDisabled(e){return(this.optionDisabled?a.gb.resolveFieldData(e,this.optionDisabled):void 0!==e.disabled&&e.disabled)||this.maxSelectionLimitReached&&!this.isSelected(e)}writeValue(e){this.value=e,this.updateLabel(),this.updateFilledState(),this.checkSelectionLimit(),this.cd.markForCheck()}checkSelectionLimit(){this.maxSelectionLimitReached=!(!this.selectionLimit||!this.value||this.value.length!==this.selectionLimit)}updateFilledState(){this.filled=this.value&&this.value.length>0}registerOnChange(e){this.onModelChange=e}registerOnTouched(e){this.onModelTouched=e}setDisabledState(e){this.disabled=e,this.cd.markForCheck()}onOptionClick(e){let t=e.option;if(this.isOptionDisabled(t))return;let n=this.getOptionValue(t),i=this.findSelectionIndex(n);-1!=i?(this.value=this.value.filter((e,t)=>t!=i),this.selectionLimit&&(this.maxSelectionLimitReached=!1)):((!this.selectionLimit||!this.value||this.value.length<this.selectionLimit)&&(this.value=[...this.value||[],n]),this.checkSelectionLimit()),this.onModelChange(this.value),this.onChange.emit({originalEvent:e.originalEvent,value:this.value,itemValue:n}),this.updateLabel(),this.updateFilledState()}isSelected(e){return-1!=this.findSelectionIndex(this.getOptionValue(e))}findSelectionIndex(e){let t=-1;if(this.value)for(let n=0;n<this.value.length;n++)if(a.gb.equals(this.value[n],e,this.dataKey)){t=n;break}return t}get toggleAllDisabled(){let e=this.optionsToRender;if(!e||0===e.length)return!0;for(let t of e)if(!this.isOptionDisabled(t))return!1;return!0}toggleAll(e){this.disabled||this.toggleAllDisabled||this.readonly||(this.allChecked?this.uncheckAll():this.checkAll(),this.onModelChange(this.value),this.onChange.emit({originalEvent:e,value:this.value}),this.updateFilledState(),this.updateLabel(),e.preventDefault())}checkAll(){let e=[];this.optionsToRender.forEach(t=>{if(this.group){let n=this.getOptionGroupChildren(t);n&&n.forEach(t=>{let n=this.isOptionDisabled(t);(!n||n&&this.isSelected(t))&&e.push(this.getOptionValue(t))})}else{let n=this.isOptionDisabled(t);(!n||n&&this.isSelected(t))&&e.push(this.getOptionValue(t))}}),this.value=e}uncheckAll(){let e=[];this.optionsToRender.forEach(t=>{this.group?t.items&&t.items.forEach(t=>{this.isOptionDisabled(t)&&this.isSelected(t)&&e.push(this.getOptionValue(t))}):this.isOptionDisabled(t)&&this.isSelected(t)&&e.push(this.getOptionValue(t))}),this.value=e}show(){this.overlayVisible||(this.overlayVisible=!0)}onOverlayClick(e){this.overlayService.add({originalEvent:e,target:this.el.nativeElement})}onOverlayAnimationStart(e){switch(e.toState){case"visible":this.overlay=e.element,this.appendOverlay(),this.autoZIndex&&a.P9.set("overlay",this.overlay,this.config.zIndex.overlay),this.alignOverlay(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener(),this.filterInputChild&&this.filterInputChild.nativeElement&&(this.preventModelTouched=!0,this.autofocusFilter&&this.filterInputChild.nativeElement.focus()),this.onPanelShow.emit();break;case"void":this.onOverlayHide()}}onOverlayAnimationEnd(e){switch(e.toState){case"void":a.P9.clear(e.element)}}appendOverlay(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.overlay):r.p.appendChild(this.overlay,this.appendTo),this.overlay.style.minWidth||(this.overlay.style.minWidth=r.p.getWidth(this.containerViewChild.nativeElement)+"px"))}restoreOverlayAppend(){this.overlay&&this.appendTo&&this.el.nativeElement.appendChild(this.overlay)}alignOverlay(){this.overlay&&(this.appendTo?r.p.absolutePosition(this.overlay,this.containerViewChild.nativeElement):r.p.relativePosition(this.overlay,this.containerViewChild.nativeElement))}hide(){this.overlayVisible=!1,this.unbindDocumentClickListener(),this.resetFilterOnHide&&(this.filterInputChild.nativeElement.value="",this._filterValue=null,this._filteredOptions=null),this.onPanelHide.emit(),this.cd.markForCheck()}close(e){this.hide(),e.preventDefault(),e.stopPropagation()}onMouseclick(e,t){this.disabled||this.readonly||e.target.isSameNode(this.accessibleViewChild.nativeElement)||(this.onClick.emit(e),!this.isOverlayClick(e)&&!r.p.hasClass(e.target,"p-multiselect-token-icon")&&(this.overlayVisible?this.hide():(t.focus(),this.show())))}removeChip(e,t){this.value=this.value.filter(t=>!a.gb.equals(t,e,this.dataKey)),this.onModelChange(this.value),this.checkSelectionLimit(),this.onChange.emit({originalEvent:t,value:this.value,itemValue:e}),this.updateLabel(),this.updateFilledState()}isOverlayClick(e){let t=e.target;return!!this.overlay&&(this.overlay.isSameNode(t)||this.overlay.contains(t))}isOutsideClicked(e){return!(this.el.nativeElement.isSameNode(e.target)||this.el.nativeElement.contains(e.target)||this.isOverlayClick(e))}onInputFocus(e){this.focus=!0,this.onFocus.emit({originalEvent:e})}onInputBlur(e){this.focus=!1,this.onBlur.emit({originalEvent:e}),this.preventModelTouched||this.onModelTouched(),this.preventModelTouched=!1}onOptionKeydown(e){if(!this.readonly)switch(e.originalEvent.which){case 40:var t=this.findNextItem(e.originalEvent.target.parentElement);t&&t.focus(),e.originalEvent.preventDefault();break;case 38:var n=this.findPrevItem(e.originalEvent.target.parentElement);n&&n.focus(),e.originalEvent.preventDefault();break;case 13:this.onOptionClick(e),e.originalEvent.preventDefault()}}findNextItem(e){let t=e.nextElementSibling;return t?r.p.hasClass(t.children[0],"p-disabled")||r.p.isHidden(t.children[0])||r.p.hasClass(t,"p-multiselect-item-group")?this.findNextItem(t):t.children[0]:null}findPrevItem(e){let t=e.previousElementSibling;return t?r.p.hasClass(t.children[0],"p-disabled")||r.p.isHidden(t.children[0])||r.p.hasClass(t,"p-multiselect-item-group")?this.findPrevItem(t):t.children[0]:null}onKeydown(e){switch(e.which){case 40:!this.overlayVisible&&e.altKey&&(this.show(),e.preventDefault());break;case 32:this.overlayVisible||(this.show(),e.preventDefault());break;case 27:this.hide()}}updateLabel(){if(this.value&&this.options&&this.value.length&&this.displaySelectedLabel){let e="";for(let t=0;t<this.value.length;t++){let n=this.findLabelByValue(this.value[t]);n&&(e.length>0&&(e+=", "),e+=n)}if(this.value.length<=this.maxSelectedLabels||"ellipsis"===this.selectedItemsLabel)this.valuesAsString=e;else{let e=/{(.*?)}/;this.valuesAsString=e.test(this.selectedItemsLabel)?this.selectedItemsLabel.replace(this.selectedItemsLabel.match(e)[0],this.value.length+""):this.selectedItemsLabel}}else this.valuesAsString=this.placeholder||this.defaultLabel}findLabelByValue(e){if(this.group){let t=null;for(let n=0;n<this.options.length;n++){let i=this.getOptionGroupChildren(this.options[n]);if(i&&(t=this.searchLabelByValue(e,i),t))break}return t}return this.searchLabelByValue(e,this.options)}searchLabelByValue(e,t){let n=null;for(let i=0;i<t.length;i++){let o=t[i],l=this.getOptionValue(o);if(null==e&&null==l||a.gb.equals(e,l,this.dataKey)){n=this.getOptionLabel(o);break}}return n}get allChecked(){let e=this.optionsToRender;if(!e||0===e.length)return!1;{let t=0,n=0,i=0,o=this.group?0:this.optionsToRender.length;for(let l of e)if(this.group)for(let e of this.getOptionGroupChildren(l)){let l=this.isOptionDisabled(e),r=this.isSelected(e);if(l)r?t++:n++;else{if(!r)return!1;i++}o++}else{let e=this.isOptionDisabled(l),o=this.isSelected(l);if(e)o?t++:n++;else{if(!o)return!1;i++}}return o===t||o===i||i&&o===i+n+t}}get optionsToRender(){return this._filteredOptions||this.options}get emptyOptions(){let e=this.optionsToRender;return!e||0===e.length}get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(s.ws.EMPTY_MESSAGE)}get emptyFilterMessageLabel(){return this.emptyFilterMessage||this.config.getTranslation(s.ws.EMPTY_FILTER_MESSAGE)}hasFilter(){return this._filterValue&&this._filterValue.trim().length>0}onFilterInputChange(e){this._filterValue=e.target.value,this.activateFilter(),this.onFilter.emit({originalEvent:e,filter:this._filterValue}),this.cd.detectChanges(),this.alignOverlay()}activateFilter(){if(this.hasFilter()&&this._options){let e=(this.filterBy||this.optionLabel||"label").split(",");if(this.group){let e=(this.optionLabel||"label").split(","),t=[];for(let n of this.options){let i=this.filterService.filter(this.getOptionGroupChildren(n),e,this.filterValue,this.filterMatchMode,this.filterLocale);i&&i.length&&t.push(Object.assign(Object.assign({},n),{[this.optionGroupChildren]:i}))}this._filteredOptions=t}else this._filteredOptions=this.filterService.filter(this.options,e,this._filterValue,this.filterMatchMode,this.filterLocale)}else this._filteredOptions=null}onHeaderCheckboxFocus(){this.headerCheckboxFocus=!0}onHeaderCheckboxBlur(){this.headerCheckboxFocus=!1}bindDocumentClickListener(){this.documentClickListener||(this.documentClickListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","click",e=>{this.isOutsideClicked(e)&&this.hide()}))}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}onWindowResize(){r.p.isAndroid()||this.hide()}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new r.V(this.containerViewChild.nativeElement,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}onOverlayHide(){this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.overlay=null,this.onModelTouched()}ngOnDestroy(){this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&a.P9.clear(this.overlay),this.restoreOverlayAppend(),this.onOverlayHide()}}return e.\u0275fac=function(t){return new(t||e)(i.\u0275\u0275directiveInject(i.ElementRef),i.\u0275\u0275directiveInject(i.Renderer2),i.\u0275\u0275directiveInject(i.ChangeDetectorRef),i.\u0275\u0275directiveInject(s.iZ),i.\u0275\u0275directiveInject(s.b4),i.\u0275\u0275directiveInject(s.F0))},e.\u0275cmp=i.\u0275\u0275defineComponent({type:e,selectors:[["p-multiSelect"]],contentQueries:function(e,t,n){if(1&e&&(i.\u0275\u0275contentQuery(n,s.$_,5),i.\u0275\u0275contentQuery(n,s.h4,5),i.\u0275\u0275contentQuery(n,s.jx,4)),2&e){let e;i.\u0275\u0275queryRefresh(e=i.\u0275\u0275loadQuery())&&(t.footerFacet=e.first),i.\u0275\u0275queryRefresh(e=i.\u0275\u0275loadQuery())&&(t.headerFacet=e.first),i.\u0275\u0275queryRefresh(e=i.\u0275\u0275loadQuery())&&(t.templates=e)}},viewQuery:function(e,t){if(1&e&&(i.\u0275\u0275viewQuery(x,5),i.\u0275\u0275viewQuery(C,5),i.\u0275\u0275viewQuery(b,5)),2&e){let e;i.\u0275\u0275queryRefresh(e=i.\u0275\u0275loadQuery())&&(t.containerViewChild=e.first),i.\u0275\u0275queryRefresh(e=i.\u0275\u0275loadQuery())&&(t.filterInputChild=e.first),i.\u0275\u0275queryRefresh(e=i.\u0275\u0275loadQuery())&&(t.accessibleViewChild=e.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:4,hostBindings:function(e,t){2&e&&i.\u0275\u0275classProp("p-inputwrapper-filled",t.filled)("p-inputwrapper-focus",t.focus||t.overlayVisible)},inputs:{style:"style",styleClass:"styleClass",panelStyle:"panelStyle",panelStyleClass:"panelStyleClass",inputId:"inputId",disabled:"disabled",readonly:"readonly",group:"group",filter:"filter",filterPlaceHolder:"filterPlaceHolder",filterLocale:"filterLocale",overlayVisible:"overlayVisible",tabindex:"tabindex",appendTo:"appendTo",dataKey:"dataKey",name:"name",ariaLabelledBy:"ariaLabelledBy",displaySelectedLabel:"displaySelectedLabel",maxSelectedLabels:"maxSelectedLabels",selectionLimit:"selectionLimit",selectedItemsLabel:"selectedItemsLabel",showToggleAll:"showToggleAll",emptyFilterMessage:"emptyFilterMessage",emptyMessage:"emptyMessage",resetFilterOnHide:"resetFilterOnHide",dropdownIcon:"dropdownIcon",optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",optionGroupLabel:"optionGroupLabel",optionGroupChildren:"optionGroupChildren",showHeader:"showHeader",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",filterBy:"filterBy",virtualScroll:"virtualScroll",itemSize:"itemSize",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",ariaFilterLabel:"ariaFilterLabel",filterMatchMode:"filterMatchMode",tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",autofocusFilter:"autofocusFilter",display:"display",scrollHeight:"scrollHeight",defaultLabel:"defaultLabel",placeholder:"placeholder",options:"options",filterValue:"filterValue"},outputs:{onChange:"onChange",onFilter:"onFilter",onFocus:"onFocus",onBlur:"onBlur",onClick:"onClick",onPanelShow:"onPanelShow",onPanelHide:"onPanelHide"},features:[i.\u0275\u0275ProvidersFeature([me])],ngContentSelectors:pe,decls:12,vars:32,consts:[[3,"ngClass","ngStyle","click"],["container",""],[1,"p-hidden-accessible"],["type","text","readonly","readonly","aria-haspopup","listbox","role","listbox",3,"disabled","focus","blur","keydown"],["in",""],[1,"p-multiselect-label-container",3,"pTooltip","tooltipPosition","positionStyle","tooltipStyleClass"],[1,"p-multiselect-label",3,"ngClass"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass"],[1,"p-multiselect-trigger-icon",3,"ngClass"],["onOverlayAnimationEnd","",3,"ngClass","ngStyle","class","keydown","click",4,"ngIf"],["class","p-multiselect-token",4,"ngFor","ngForOf"],[1,"p-multiselect-token"],["token",""],[1,"p-multiselect-token-label"],["class","p-multiselect-token-icon pi pi-times-circle",3,"click",4,"ngIf"],[1,"p-multiselect-token-icon","pi","pi-times-circle",3,"click"],["onOverlayAnimationEnd","",3,"ngClass","ngStyle","keydown","click"],["class","p-multiselect-header",4,"ngIf"],[1,"p-multiselect-items-wrapper"],["role","listbox","aria-multiselectable","true",1,"p-multiselect-items","p-component",3,"ngClass"],["itemslist",""],["class","p-multiselect-footer",4,"ngIf"],[1,"p-multiselect-header"],[4,"ngTemplateOutlet"],["class","p-checkbox p-component",3,"ngClass",4,"ngIf"],["class","p-multiselect-filter-container",4,"ngIf"],["type","button","pRipple","",1,"p-multiselect-close","p-link",3,"click"],[1,"p-multiselect-close-icon","pi","pi-times"],[1,"p-checkbox","p-component",3,"ngClass"],["type","checkbox","readonly","readonly",3,"checked","disabled","focus","blur","keydown.space"],["role","checkbox",1,"p-checkbox-box",3,"ngClass","click"],[1,"p-checkbox-icon",3,"ngClass"],[1,"p-multiselect-filter-container"],["type","text","role","textbox",1,"p-multiselect-filter","p-inputtext","p-component",3,"value","disabled","input"],["filterInput",""],[1,"p-multiselect-filter-icon","pi","pi-search"],["ngFor","",3,"ngForOf"],[1,"p-multiselect-item-group"],[4,"ngIf","ngIfElse"],["virtualScrollList",""],["class","p-multiselect-empty-message",4,"ngIf"],[3,"option","selected","label","disabled","template","onClick","onKeydown"],[3,"ngStyle","itemSize",4,"ngIf"],[3,"ngStyle","itemSize"],["viewport",""],[4,"cdkVirtualFor","cdkVirtualForOf"],[3,"option","selected","label","disabled","template","itemSize","onClick","onKeydown"],[1,"p-multiselect-empty-message"],["emptyFilter",""],["empty",""],[1,"p-multiselect-footer"]],template:function(e,t){if(1&e){const e=i.\u0275\u0275getCurrentView();i.\u0275\u0275projectionDef(se),i.\u0275\u0275elementStart(0,"div",0,1),i.\u0275\u0275listener("click",function(n){i.\u0275\u0275restoreView(e);const o=i.\u0275\u0275reference(4);return t.onMouseclick(n,o)}),i.\u0275\u0275elementStart(2,"div",2),i.\u0275\u0275elementStart(3,"input",3,4),i.\u0275\u0275listener("focus",function(e){return t.onInputFocus(e)})("blur",function(e){return t.onInputBlur(e)})("keydown",function(e){return t.onKeydown(e)}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(5,"div",5),i.\u0275\u0275elementStart(6,"div",6),i.\u0275\u0275template(7,T,3,2,"ng-container",7),i.\u0275\u0275template(8,w,1,0,"ng-container",8),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(9,"div",9),i.\u0275\u0275element(10,"span",10),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(11,ae,9,20,"div",11),i.\u0275\u0275elementEnd()}2&e&&(i.\u0275\u0275classMap(t.styleClass),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction4(21,de,t.overlayVisible,"chip"===t.display,t.focus,t.disabled))("ngStyle",t.style),i.\u0275\u0275advance(3),i.\u0275\u0275property("disabled",t.disabled),i.\u0275\u0275attribute("id",t.inputId)("name",t.name)("tabindex",t.tabindex)("aria-expanded",t.overlayVisible)("aria-labelledby",t.ariaLabelledBy),i.\u0275\u0275advance(2),i.\u0275\u0275property("pTooltip",t.tooltip)("tooltipPosition",t.tooltipPosition)("positionStyle",t.tooltipPositionStyle)("tooltipStyleClass",t.tooltipStyleClass),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction2(26,ce,t.valuesAsString===(t.defaultLabel||t.placeholder),!(null!=t.valuesAsString&&0!==t.valuesAsString.length||null!=t.placeholder&&0!==t.placeholder.length))),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",!t.selectedItemsTemplate),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngTemplateOutlet",t.selectedItemsTemplate)("ngTemplateOutletContext",i.\u0275\u0275pureFunction1(29,S,t.value)),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction0(31,ue)),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngClass",t.dropdownIcon),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngIf",t.overlayVisible))},directives:[l.NgClass,l.NgStyle,u.u,l.NgIf,l.NgTemplateOutlet,l.NgForOf,p.H,fe,c.N7,c.xd,c.x0],styles:[".p-multiselect{display:inline-flex;cursor:pointer;position:relative;-webkit-user-select:none;-ms-user-select:none;user-select:none}.p-multiselect-trigger{display:flex;align-items:center;justify-content:center;flex-shrink:0}.p-multiselect-label-container{overflow:hidden;flex:1 1 auto;cursor:pointer}.p-multiselect-label{display:block;white-space:nowrap;cursor:pointer;overflow:hidden;text-overflow:ellipsis}.p-multiselect-label-empty{overflow:hidden;visibility:hidden}.p-multiselect-token{cursor:default;display:inline-flex;align-items:center;flex:0 0 auto}.p-multiselect-token-icon{cursor:pointer}.p-multiselect .p-multiselect-panel{min-width:100%}.p-multiselect-panel{position:absolute;top:0;left:0}.p-multiselect-items-wrapper{overflow:auto}.p-multiselect-items{margin:0;padding:0;list-style-type:none}.p-multiselect-item{cursor:pointer;display:flex;align-items:center;font-weight:400;white-space:nowrap;position:relative;overflow:hidden}.p-multiselect-header{display:flex;align-items:center;justify-content:space-between}.p-multiselect-filter-container{position:relative;flex:1 1 auto}.p-multiselect-filter-icon{position:absolute;top:50%;margin-top:-.5rem}.p-multiselect-filter-container .p-inputtext{width:100%}.p-multiselect-close{display:flex;align-items:center;justify-content:center;flex-shrink:0;overflow:hidden;position:relative}.p-fluid .p-multiselect{display:flex}"],encapsulation:2,data:{animation:[(0,o.X$)("overlayAnimation",[(0,o.eR)(":enter",[(0,o.oB)({opacity:0,transform:"scaleY(0.8)"}),(0,o.jt)("{{showTransitionParams}}")]),(0,o.eR)(":leave",[(0,o.jt)("{{hideTransitionParams}}",(0,o.oB)({opacity:0}))])])]},changeDetection:0}),e})(),ge=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=i.\u0275\u0275defineInjector({imports:[[l.CommonModule,s.m8,c.Cl,u.z,p.T],s.m8,c.Cl]}),e})()},37300:function(e,t,n){n.d(t,{m:function(){return r}});var i=n(6452),o=n(37716),l=n(91841);let r=(()=>{class e{constructor(e){this.httpClient=e}downloadTemplate(e){return this.httpClient.post(i.f.GENERATE_LOAN_REPORT,e,{responseType:"blob"})}downloadCustomReport(e){return this.httpClient.post(i.f.GENERATE_CUSTOM_REPORT,e,{responseType:"blob"})}}return e.\u0275fac=function(t){return new(t||e)(o.\u0275\u0275inject(l.eN))},e.\u0275prov=o.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},49124:function(e,t,n){n.d(t,{Y:function(){return j}});var i=n(8239),o=n(37716),l=n(30165),r=n(3679),a=n(37990),s=n(72114),d=n(55041),c=n(32132),u=n(94806),p=n(26772),m=n(43073),f=n(40572),h=n(58762),g=n(57702),v=n(22134),y=n(38583),S=n(88075),x=n(85627),C=n(65981),b=n(37300),E=n(61181),I=n(29790),L=n(28970),F=n(99266),D=n(25465),T=n(57552),w=n(70946);function O(e,t){1&e&&(o.\u0275\u0275elementStart(0,"h6",4),o.\u0275\u0275text(1),o.\u0275\u0275pipe(2,"translate"),o.\u0275\u0275elementEnd()),2&e&&(o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(2,1,"upload_document.missing_document")," "))}function k(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div",17),o.\u0275\u0275elementStart(1,"div",18),o.\u0275\u0275element(2,"input",19),o.\u0275\u0275elementStart(3,"label",20),o.\u0275\u0275text(4),o.\u0275\u0275pipe(5,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext(4);o.\u0275\u0275advance(2),o.\u0275\u0275property("checked",0!==e.repaymentFee),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(5,2,"loan.admin_fees_paid"))}}function G(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"button",28),o.\u0275\u0275listener("click",function(){o.\u0275\u0275restoreView(e);const t=o.\u0275\u0275nextContext().$implicit;return o.\u0275\u0275nextContext(4).downloadTemplate(t)}),o.\u0275\u0275element(1,"i",38),o.\u0275\u0275elementEnd()}}function R(e,t){1&e&&(o.\u0275\u0275elementStart(0,"span",39),o.\u0275\u0275text(1," *"),o.\u0275\u0275elementEnd())}function _(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"button",40),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(e),o.\u0275\u0275reference(4).click()}),o.\u0275\u0275elementStart(1,"fa",41),o.\u0275\u0275element(2,"i",42),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(3,"input",43,44),o.\u0275\u0275listener("change",function(t){o.\u0275\u0275restoreView(e);const n=o.\u0275\u0275nextContext().$implicit,i=o.\u0275\u0275nextContext(4);return i.onUpload(t,n,i.category)}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()}if(2&e){const e=o.\u0275\u0275nextContext().$implicit;o.\u0275\u0275property("disabled",!e.file)}}function A(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"tr"),o.\u0275\u0275elementStart(1,"td"),o.\u0275\u0275template(2,G,2,0,"button",21),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(3,"td"),o.\u0275\u0275elementStart(4,"div",22),o.\u0275\u0275elementStart(5,"div",23),o.\u0275\u0275elementStart(6,"div",24),o.\u0275\u0275elementStart(7,"div",25),o.\u0275\u0275text(8),o.\u0275\u0275template(9,R,2,0,"span",26),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(10,"td"),o.\u0275\u0275elementStart(11,"div",27),o.\u0275\u0275text(12),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(13,"td"),o.\u0275\u0275elementStart(14,"div",27),o.\u0275\u0275text(15),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(16,"td"),o.\u0275\u0275elementStart(17,"div",27),o.\u0275\u0275text(18),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(19,"td",27),o.\u0275\u0275elementStart(20,"button",28),o.\u0275\u0275listener("click",function(){const t=o.\u0275\u0275restoreView(e).$implicit;o.\u0275\u0275nextContext(2);const n=o.\u0275\u0275reference(5);return o.\u0275\u0275nextContext(2).openLarge(n,t)}),o.\u0275\u0275element(21,"i",29),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(22,"td",27),o.\u0275\u0275elementStart(23,"form",30),o.\u0275\u0275elementStart(24,"button",28),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(e),o.\u0275\u0275reference(27).click()}),o.\u0275\u0275element(25,"i",31),o.\u0275\u0275elementStart(26,"input",32,33),o.\u0275\u0275listener("change",function(t){const n=o.\u0275\u0275restoreView(e).$implicit,i=o.\u0275\u0275nextContext(4);return i.onFileSelected(t,n,i.category)}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(28,"td",34),o.\u0275\u0275elementStart(29,"button",35),o.\u0275\u0275listener("click",function(){const t=o.\u0275\u0275restoreView(e).$implicit;return o.\u0275\u0275nextContext(4).view(t.file,t.idfile)}),o.\u0275\u0275element(30,"i",36),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(31,"td",34),o.\u0275\u0275elementStart(32,"form",30),o.\u0275\u0275template(33,_,5,1,"button",37),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=o.\u0275\u0275nextContext(4);o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",null!=e.reportName&&""!==e.reportName),o.\u0275\u0275advance(6),o.\u0275\u0275textInterpolate(e.title),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",e.mandatory===n.status),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1(" ",e.name," "),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1(" ",e.date," "),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1(" ",e.updatedBy," "),o.\u0275\u0275advance(5),o.\u0275\u0275property("formGroup",n.documentForm),o.\u0275\u0275advance(3),o.\u0275\u0275property("name","file"+e.title),o.\u0275\u0275advance(6),o.\u0275\u0275property("formGroup",n.addDocumentForm),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",e.settingDocumentType.uniqueness&&1===e.documentIndex)}}function V(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"div",5),o.\u0275\u0275elementStart(1,"div",6),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(e),o.\u0275\u0275nextContext(3).toggleCollapse()}),o.\u0275\u0275elementStart(2,"div"),o.\u0275\u0275element(3,"i",7),o.\u0275\u0275text(4),o.\u0275\u0275pipe(5,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(6,"div"),o.\u0275\u0275element(7,"i",8),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(8,"div",9),o.\u0275\u0275elementStart(9,"div",10),o.\u0275\u0275template(10,k,6,4,"div",11),o.\u0275\u0275elementStart(11,"table",12),o.\u0275\u0275elementStart(12,"thead"),o.\u0275\u0275elementStart(13,"tr"),o.\u0275\u0275elementStart(14,"th",13),o.\u0275\u0275text(15),o.\u0275\u0275pipe(16,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(17,"th",13),o.\u0275\u0275text(18),o.\u0275\u0275pipe(19,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(20,"th",14),o.\u0275\u0275text(21),o.\u0275\u0275pipe(22,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(23,"th",14),o.\u0275\u0275text(24),o.\u0275\u0275pipe(25,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(26,"th",15),o.\u0275\u0275text(27),o.\u0275\u0275pipe(28,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(29,"th",15),o.\u0275\u0275text(30),o.\u0275\u0275pipe(31,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(32,"th",15),o.\u0275\u0275text(33),o.\u0275\u0275pipe(34,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(35,"th",15),o.\u0275\u0275element(36,"th",15),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(37,"tbody"),o.\u0275\u0275template(38,A,34,10,"tr",16),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()}if(2&e){const e=o.\u0275\u0275nextContext(3);o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate2(" ",o.\u0275\u0275pipeBind1(5,13,"collections.collection-dashboard.documents"),": ",e.statutDocumentLoan," "),o.\u0275\u0275advance(3),o.\u0275\u0275property("ngClass",!0===e.expanded?"lnr-chevron-up text-secondary":"lnr-chevron-down text-secondary"),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngClass",!0===e.expanded?"collapse show":"collapse"),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",e.adminFee),o.\u0275\u0275advance(5),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(16,15,"upload_document.download_template")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(19,17,"upload_document.Title")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(22,19,"upload_document.Name")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(25,21,"upload_document.Date")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1("",o.\u0275\u0275pipeBind1(28,23,"upload_document.modify-by")," "),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1("",o.\u0275\u0275pipeBind1(31,25,"upload_document.version-history")," "),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1("",o.\u0275\u0275pipeBind1(34,27,"upload_document.Upload_new_version")," "),o.\u0275\u0275advance(5),o.\u0275\u0275property("ngForOf",e.documents)}}function N(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"tr"),o.\u0275\u0275elementStart(1,"td"),o.\u0275\u0275elementStart(2,"div",27),o.\u0275\u0275text(3),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(4,"td"),o.\u0275\u0275elementStart(5,"div",27),o.\u0275\u0275text(6),o.\u0275\u0275pipe(7,"date"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(8,"td"),o.\u0275\u0275elementStart(9,"div",27),o.\u0275\u0275text(10),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(11,"td",34),o.\u0275\u0275elementStart(12,"button",35),o.\u0275\u0275listener("click",function(){const t=o.\u0275\u0275restoreView(e).$implicit;return o.\u0275\u0275nextContext(4).view(t.file,t.idDocumentGED)}),o.\u0275\u0275element(13,"i",36),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1(" ",e.name," "),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind2(7,3,e.dateCreation,"dd/MM/yyyy hh:mm a")," "),o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate1(" ",e.insertBy," ")}}const U=function(e){return{"text-end":e}};function M(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"div",45),o.\u0275\u0275elementStart(1,"form"),o.\u0275\u0275elementStart(2,"div",46),o.\u0275\u0275elementStart(3,"h4",47),o.\u0275\u0275text(4),o.\u0275\u0275pipe(5,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(6,"button",48),o.\u0275\u0275listener("click",function(){return(0,o.\u0275\u0275restoreView(e).close)(o.\u0275\u0275nextContext(3).reset())}),o.\u0275\u0275elementStart(7,"span",49),o.\u0275\u0275text(8,"\xd7"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(9,"div",50),o.\u0275\u0275elementStart(10,"div",10),o.\u0275\u0275elementStart(11,"table",12),o.\u0275\u0275elementStart(12,"thead"),o.\u0275\u0275elementStart(13,"tr"),o.\u0275\u0275elementStart(14,"th",14),o.\u0275\u0275text(15),o.\u0275\u0275pipe(16,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(17,"th",14),o.\u0275\u0275text(18),o.\u0275\u0275pipe(19,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(20,"th",14),o.\u0275\u0275text(21),o.\u0275\u0275pipe(22,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(23,"th",15),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(24,"tbody"),o.\u0275\u0275template(25,N,14,6,"tr",16),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(26,"div",51),o.\u0275\u0275elementStart(27,"button",52),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(e),o.\u0275\u0275nextContext(3).reset()}),o.\u0275\u0275text(28),o.\u0275\u0275pipe(29,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()}if(2&e){const e=o.\u0275\u0275nextContext(3);o.\u0275\u0275propertyInterpolate("dir",e.getDirection()),o.\u0275\u0275property("ngClass",o.\u0275\u0275pureFunction1(21,U,"ar"===e.translate.currentLang)),o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(5,11,"upload_document.document-history")),o.\u0275\u0275advance(2),o.\u0275\u0275classMapInterpolate1("close ACM-modal-header-",e.translate.currentLang,""),o.\u0275\u0275advance(9),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(16,13,"upload_document.Name")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(19,15,"upload_document.Date")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1("",o.\u0275\u0275pipeBind1(22,17,"customer_decision.addedBy")," "),o.\u0275\u0275advance(4),o.\u0275\u0275property("ngForOf",e.historyDocuments),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(29,19,"button.cancel"))}}function B(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275elementStart(1,"div"),o.\u0275\u0275template(2,O,3,3,"h6",1),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(3,V,39,29,"div",2),o.\u0275\u0275template(4,M,30,23,"ng-template",null,3,o.\u0275\u0275templateRefExtractor),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",0===e.documents.length),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",0!==e.documents.length)}}function P(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275template(1,B,6,2,"div",0),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext();o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf","5"!=e.loan.statut&&"6"!=e.loan.statut&&0!==e.documents.length)}}let j=(()=>{class e{constructor(e,t,n,i,r,a,s,d,m,f,h,g){this.datePipe=e,this.gedService=t,this.devToolsServices=n,this.sharedService=i,this.reportService=r,this.formBuilder=a,this.loanSharedService=s,this.modalService=d,this.translate=m,this.settingsService=f,this.router=h,this.dbService=g,this.documentsUpload=[],this.documents=[],this.uploadedDocument=[],this.saveFilesAction=!0,this.documentListUpdated=!1,this.deletedDocument=new o.EventEmitter,this.checkRequiredDoc=new o.EventEmitter,this.saveDone=new o.EventEmitter,this.historyDocuments=[],this.status=!0,this.allDocuments=[],this.loanDTO=new l.t,this.feeRepayment=0,this.checkRequiredDocument=!1,this.settingMotifReviewEntity=new c.k,this.product=new u.J,this.isAdminFee=!1,this.issued=!1,this.settingMotifRejetsEntity=new c.k,this.settingMotifRejetsEntitys=[],this.userConnected=new p.H,this.renewelLoanCondition=!1,this.documentsToRemove=[],this.currentAmount=0,this.apportPersonnel=0,this.lengthDocuments=new o.EventEmitter,this.typeDocumentExist=new o.EventEmitter,this.statutDocumentLoan=""}ngOnInit(){var e=this;return(0,i.Z)(function*(){e.loan=e.loanSharedService.getLoan();let t=e.loan.loanInstancesDtos.filter(t=>t.code===e.loan.etapeWorkflow);e.statutDocumentLoan=t.length>0?t[0].libelle:"",e.loanSharedService.setCustomer(e.loan.customerDTO),"check-collateral"==e.category&&(e.loan.productId=e.loanDto.productId,e.loan.statutWorkflow=e.loanDto.statutWorkflow);const n=new Date;n.setHours(0,0,0,0),e.minIssueDatevalue=e.datePipe.transform(n.setDate(n.getDate()),"yyyy-MM-dd"),e.apportPersonnel=e.loan.personalContribution,e.currentAmount=e.loan.approvelAmount+e.apportPersonnel,e.pageSize=5,e.page=1,e.userConnected=e.loanSharedService.getUser(),e.loan.statutWorkflow===h.J.STATUT_WORKFLOW_REVIEW&&(e.loan.statutWorkflow=e.loan.etapeWorkflow);let i=e.router.url,o=e.loan.loanInstancesDtos.filter(e=>"/acm"+e.ihmRoot===i||"/acm/"+e.ihmRoot===i)[0];e.sharedService.getPreviousStep()&&void 0!==o&&(e.loan.etapeWorkflow>23?(e.loan.statutWorkflow=o.code,e.statutDocumentLoan=o.libelle):(e.loan.etapeWorkflow=o.code,e.statutDocumentLoan=o.libelle));const l=[h.J.ADMIN_FEE,h.J.RENEWEL_LOAN_CONDITION,h.J.DEFERRED_PERIODE_TYPES];(0,v.L0)()?(e.dbService.getByKey("data","getRequiredDocumentByStep_"+e.loan.etapeWorkflow).subscribe(t=>{void 0===t?e.devToolsServices.openToast(3,"No required documents saved for offline use"):(t.data.map(t=>{const n=new f.G;n.settingDocumentType=t,n.title=t.libelle,n.mandatory=t.mandatory,n.name="-",n.date="-",n.file="",n.idfile="",n.idDocument=null,n.documentIndex=1,n.reportName=t.reportName,e.documents.push(n)}),e.checkRequired(),0!==e.documents.length&&e.typeDocumentExist.emit(!0),e.fillDocument())}),e.dbService.getByKey("data","envirement-values-by-keys-upload").subscribe(t=>{void 0===t&&e.devToolsServices.openToast(3,"No env values by keys upload fields saved for offline use")})):(e.gedService.getRequiredDocument(e.loan).subscribe(t=>{t.map(t=>{const n=new f.G;n.settingDocumentType=t,n.title=t.libelle,n.mandatory=t.mandatory,n.name="-",n.date="-",n.file="",n.idfile="",n.idDocument=null,n.documentIndex=1,n.reportName=t.reportName,e.documents.push(n),e.lengthDocuments.emit(1)}),e.checkRequired(),0!==e.documents.length&&e.typeDocumentExist.emit(!0),e.loan.assignCustomer&&e.loan.idIbLoan?e.sharedService.ibDocumentsReceived.subscribe(t=>{t&&e.fillDocument()}):e.fillDocument()}),e.settingsService.getEnvirementValueByKeys(l).subscribe(t=>{"1"===t[0].value&&"1"===e.loanSharedService.useExternalCBS&&e.gedService.getFeeRepayment(e.loan.idAccountExtern).subscribe(t=>{e.isAdminFee=!0,e.feeRepayment=t}),"1"===t[1].value&&(e.renewelLoanCondition=!0)})),e.loan=e.sharedService.getLoan(),e.createForm(),e.documentForm=e.formBuilder.group({});for(let a=0;a<e.documents.length;a++)e.documentForm.addControl("documentInput"+a,new r.NI(""))})()}ngOnChanges(e){this.save()}createForm(){this.addDocumentForm=this.formBuilder.group({fileInput:[""]})}onFileSelected(e,t,n){this.sharedService.geTypeMimes().includes(e.target.files[0].type)?e.target.files[0].size<=this.sharedService.getMaxSizeFileUpload()?e.target.files.length>0&&(this.document={name:e.target.files[0].name,settingDocumentType:t.settingDocumentType,title:""+t.title,date:this.datePipe.transform(Date.now(),"yyyy/MM/dd"),file:e.target.files[0],mandatory:t.mandatory,updatedBy:this.sharedService.user.fullName,documentIndex:t.documentIndex},this.uploadedDocument={document:this.document,category:n},this.addDocuments(this.uploadedDocument)):this.devToolsServices.openToastForMaxSizeImg(3,"alert.file_size",this.sharedService.getMaxSizeFileUpload()):this.devToolsServices.openToast(3,"alert.file_type")}getMimeType(e){switch(e){case"pdf":return this.sharedService.typeMimes[0];case"docx":return this.sharedService.typeMimes[7];case"doc":return this.sharedService.typeMimes[1];case"xlsx":return this.sharedService.typeMimes[8];case"xls":return this.sharedService.typeMimes[2];case"pptx":return this.sharedService.typeMimes[5];case"ppt":return this.sharedService.typeMimes[6];case"jpeg":case"jpg":return this.sharedService.typeMimes[3];case"png":return this.sharedService.typeMimes[4];default:return""}}view(e,t){if(""!==t&&null!=t)this.gedService.getDocumentType(t).subscribe(e=>{const n=e.mimeType;this.gedService.getDocument(t).subscribe(e=>{const t=new Blob([e],{type:n}),i=window.URL.createObjectURL(t);window.open(i,"_blank")})});else{const t=URL.createObjectURL(e);window.open(t,"_blank")}}remove(e,t,n){this.devToolsServices.openConfirmDialogWithoutRedirect("confirmation_dialog.delete").afterClosed().subscribe(i=>{i&&(this.deletedDocument.emit({document:e,category:t}),this.documentForm.controls["documentInput"+n].reset())})}downloadTemplate(e){const t=new a.f;t.settingDocumentTypeDTO=e.settingDocumentType,t.productId=this.loan.productId,this.gedService.findAllDocumentProduct(t).subscribe(e=>{if(null!=e[0].reportName){const t=new s.B;t.inputFileName=e[0].reportName;const n=[];n.push(this.loan),t.entryList=n,t.typeReport="AGREEMENT",this.reportService.downloadCustomReport(t).subscribe(e=>{const t=new Blob([e],{type:"application/pdf"}),n=window.URL.createObjectURL(t);window.open(n,"_blank")})}else this.devToolsServices.openToast(1,"alert.file_type")})}onUpload(e,t,n){this.documentForm.addControl("documentInput"+this.documents.length,new r.NI(""));const i=Math.max.apply(Math,this.documents.map(e=>e.documentIndex));this.sharedService.geTypeMimes().includes(e.target.files[0].type)?e.target.files[0].size<=this.sharedService.getMaxSizeFileUpload()?e.target.files.length>0&&(this.document={name:e.target.files[0].name,settingDocumentType:t.settingDocumentType,title:""+t.title,date:this.datePipe.transform(Date.now(),"yyyy/MM/dd"),file:e.target.files[0],mandatory:!1,documentIndex:i+1,updatedBy:this.sharedService.user.fullName},this.uploadedDocument={document:this.document,category:n},this.addDoc(this.uploadedDocument),this.addDocumentForm.controls.fileInput.reset()):this.devToolsServices.openToastForMaxSizeImg(3,"alert.file_size",this.sharedService.getMaxSizeFileUpload()):this.devToolsServices.openToast(3,"alert.file_type")}openLarge(e,t){this.modalService.open(e,{size:"lg"}).result.then(e=>{}),this.gedService.getHistoryListDocument(t.settingDocumentType.id,this.loan.loanId,t.documentIndex).subscribe(e=>{this.historyDocuments=e})}reset(){this.historyDocuments=[],this.modalService.dismissAll()}getDirection(){return d.y.direction}onsave(){void 0!==this.allDocuments&&0!==this.allDocuments.length||0!==this.documentsToRemove.length?this.devToolsServices.openConfirmDialogWithoutRedirect("confirmation_dialog.upload").afterClosed().subscribe(e=>{e&&this.save().then(()=>{this.allDocuments=[],this.documentsToRemove=[]})}):this.devToolsServices.openToast(3,"alert.no_document_to_save")}save(){var e=this;return(0,i.Z)(function*(){if(0!==e.documentsToRemove.length)for(const i of e.documentsToRemove)yield e.gedService.disableDocument(i).toPromise(),e.devToolsServices.openToast(0,"alert.success");let t=[],n=[];if(0!==e.allDocuments.length){for(const i of e.allDocuments){let o=new m.p,l=new g.J;l=i.settingDocumentType,""!==i.file&&(o.titre=i.title,o.description=i.settingDocumentType.description,o.auteur=h.J.AUTEUR,o.loanId=e.loan.loanId,o.settingDocumentTypeDTO=l,o.idCustomer=+e.loan.customerDTO.id,o.customerName=e.loanSharedService.getCustomerName(e.loan.customerDTO),o.accountNumberExtern=e.loan.accountNumber,o.mandatory=i.mandatory,o.name=i.file.name,o.documentIndex=i.documentIndex,o.documentSize=i.file.size,o.workFlowStepId=e.loan.etapeWorkflow,n.push(o),t.push(i.file))}if((0,v.L0)()){e.dbService.getByKey("data","getDocumentsByLoan_"+e.loan.loanId).subscribe(t=>{void 0===t&&e.devToolsServices.openToast(3,"No required documents for this loan saved for offline use")});let i=[],o=[];const l="loanDocument_"+e.loan.loanId,r=yield e.dbService.getByKey("documents",l).toPromise();void 0!==r&&(i=r.data.documentsLoanDTO.filter(e=>!n.some(t=>e.titre.toLowerCase()===t.titre.toLowerCase())),o=r.data.uploadedFiles.filter(e=>i.some(t=>t.name===e.name)));for(const e of i)n.push(e);const a=new FormData;for(const e of o)a.append("uploadedFiles",e),t.push(e);for(const e of t)a.append("uploadedFiles",e);a.append("documentsLoanDTO",JSON.stringify(n)),e.dbService.update("documents",{id:l,data:{uploadedFiles:t,documentsLoanDTO:n}}).subscribe(()=>{e.devToolsServices.openToast(0,"alert.success")},e=>console.error("Error saving data:",e)),e.dbService.update("data",{id:"getDocumentsByLoan_"+e.loan.loanId,data:n}).subscribe(()=>{e.devToolsServices.openToast(0,"alert.success")},e=>console.error("Error saving data:",e))}else for(let i=0;i<t.length;i++){const o=yield e.gedService.saveListDocuments([t[i]],[n[i]]).toPromise();e.changeIdSavedDocument(o[0],o[0].idDocument),e.checkRequired(),e.devToolsServices.openToast(0,"alert.documents_saved")}}e.saveDone.emit("done"),e.allDocuments=[]})()}changeIdSavedDocument(e,t){this.documents.map(n=>{n.title===e.titre&&n.documentIndex==n.documentIndex&&(n.idDocument=t)})}fillDocument(){var e=this;return(0,i.Z)(function*(){let t=[],n=!1;const i=new m.p;if(i.loanId=e.loan.loanId,(0,v.L0)()){const i="loanDocument_"+e.loan.loanId,o=yield e.dbService.getByKey("documents",i).toPromise();e.dbService.getByKey("data","getDocumentsByLoan_"+e.loan.loanId).subscribe(i=>{void 0===i?e.devToolsServices.openToast(3,"No required documents for this loan saved for offline use"):(e.documents.map(l=>{n=!1,i.data.map(i=>{if(i.titre===l.settingDocumentType.libelle){const r=new f.G;if(r.name=i.name,r.settingDocumentType=i.settingDocumentTypeDTO,r.date=e.datePipe.transform(i.dateCreation,"yyyy/MM/dd"),r.idfile=i.idDocumentGED,r.file=i.idDocumentGED,void 0!==o){const e=o?.data?.documentsLoanDTO.filter(e=>e.titre===i.titre);if(e){const t=o.data.uploadedFiles.filter(t=>t.name===e[0].name);t&&(r.file=t[0])}}r.idDocument=i.idDocument,r.mandatory=i.mandatory,r.documentIndex=i.documentIndex,r.updatedBy=i.updatedBy,r.title=l.title,r.reportName=l.reportName,t.push(r),n=!0}}),!1===n&&t.push(l)}),0!==t.length&&(e.documents=t),e.checkRequired())})}else e.gedService.getDocumentsByLoan(i).subscribe(i=>{e.documents.map(o=>{n=!1,i.map(i=>{if(i.titre===o.settingDocumentType.libelle){const l=new f.G;l.name=i.name,l.settingDocumentType=i.settingDocumentTypeDTO,l.date=e.datePipe.transform(i.dateCreation,"yyyy/MM/dd"),l.idfile=i.idDocumentGED,l.file=i.idDocumentGED,l.idDocument=i.idDocument,l.mandatory=i.mandatory,l.documentIndex=i.documentIndex,l.updatedBy=i.updatedBy,l.title=o.title,l.reportName=o.reportName,t.push(l),n=!0}}),!1===n&&t.push(o)}),0!==t.length&&(e.documents=t),e.checkRequired()})})()}checkRequired(){let e=0;this.documents.map(t=>{""===t.file&&!0===t.mandatory&&e++}),this.checkRequiredDocument=0===e,this.checkRequiredDoc.emit(e)}addDocuments(e){this.documents.map(t=>{t.title===e.document.title&&t.documentIndex===e.document.documentIndex&&(t.name=e.document.name,t.date=e.document.date,t.file=e.document.file,t.settingDocumentType=e.document.settingDocumentType,t.mandatory=e.document.mandatory,t.idfile="",t.idDocument=null,t.exist=!1,this.allDocuments.push(t),this.documentListUpdated=!0)}),this.checkRequired()}addDoc(e){const t=new f.G;t.title=e.document.title,t.name=e.document.name,t.date=e.document.date,t.file=e.document.file,t.settingDocumentType=e.document.settingDocumentType,t.mandatory=e.document.mandatory,t.documentIndex=e.document.documentIndex,t.idfile="",t.idDocument=null,t.exist=!1,this.allDocuments.push(t),this.documents.push(t),this.documentListUpdated=!0}toggleCollapse(){this.expanded=!this.expanded}}return e.\u0275fac=function(t){return new(t||e)(o.\u0275\u0275directiveInject(y.DatePipe),o.\u0275\u0275directiveInject(S.G),o.\u0275\u0275directiveInject(x.R),o.\u0275\u0275directiveInject(C.F),o.\u0275\u0275directiveInject(b.m),o.\u0275\u0275directiveInject(r.qu),o.\u0275\u0275directiveInject(C.F),o.\u0275\u0275directiveInject(E.FF),o.\u0275\u0275directiveInject(I.sK),o.\u0275\u0275directiveInject(L.g),o.\u0275\u0275directiveInject(F.F0),o.\u0275\u0275directiveInject(D.ys))},e.\u0275cmp=o.\u0275\u0275defineComponent({type:e,selectors:[["app-upload-item"]],inputs:{documentsUpload:"documentsUpload",category:"category",statusWorkflow:"statusWorkflow",source:"source",saveFilesAction:"saveFilesAction",originSource:"originSource",expanded:"expanded",loanDto:"loanDto",repaymentFee:"repaymentFee",adminFee:"adminFee"},outputs:{deletedDocument:"deletedDocument",checkRequiredDoc:"checkRequiredDoc",saveDone:"saveDone",lengthDocuments:"lengthDocuments",typeDocumentExist:"typeDocumentExist"},features:[o.\u0275\u0275NgOnChangesFeature],decls:2,vars:3,consts:[[4,"ngIf"],["style","color: red;","class","pt-3",4,"ngIf"],["class","main-card mb-1 card",4,"ngIf"],["content",""],[1,"pt-3",2,"color","red"],[1,"main-card","mb-1","card"],["id","headingOne","data-target","#collapseCustomerNote","aria-expanded","true","aria-controls","collapseCustomerNote",1,"card-header","d-flex","justify-content-between",3,"click"],[1,"lnr-book","text-secondary","px-2"],[3,"ngClass"],["id","collapseCustomerNote","aria-labelledby","headingOne",3,"ngClass"],[1,"table-responsive"],["class","pb-3 px-1 mt-4 ms-4",4,"ngIf"],[1,"align-middle","mb-0","table","table-hover"],[1,"ACM-document-table-column"],[1,"text-center","ACM-document-table-column"],[1,"text-center","ACM-document-table-column-button"],[4,"ngFor","ngForOf"],[1,"pb-3","px-1","mt-4","ms-4"],[1,"custom-checkbox","custom-control"],["type","checkbox","disabled","",1,"custom-control-input",3,"checked"],[1,"custom-control-label"],["class","mb-2 mx-2 btn-icon btn-icon-only btn-shadow btn-dashed btn btn-outline-focus","type","button",3,"click",4,"ngIf"],[1,"widget-content","p-0"],[1,"widget-content-wrapper"],[1,"widget-content-left","flex2"],[1,"widget-heading"],["class","text-danger",4,"ngIf"],[1,"text-center"],["type","button",1,"mb-2","mx-2","btn-icon","btn-icon-only","btn-shadow","btn-dashed","btn","btn-outline-focus",3,"click"],[1,"pe-7s-folder","btn-icon-wrapper"],[1,"form",3,"formGroup"],[1,"pe-7s-cloud-upload","btn-icon-wrapper"],["type","file",2,"display","none",3,"name","change"],["fileInput",""],[1,"text-center","px-0"],[1,"btn","btn-warning",3,"click"],[1,"pe-7s-look","btn-icon-wrapper","text-white"],["class","btn-shadow d-inline-flex align-items-center btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"pe-7s-cloud-download","btn-icon-wrapper"],[1,"text-danger"],[1,"btn-shadow","d-inline-flex","align-items-center","btn","btn-primary",3,"disabled","click"],["name","plus","_nghost-gyt-c2","","ng-reflect-name","plus"],["aria-hidden","true","ng-reflect-klass","fa fa-plus",1,"fa","fa-plus"],["type","file","name","file","formControlName","fileInput",2,"display","none",3,"change"],["fileuploadMultiple",""],[3,"dir","ngClass"],[1,"modal-header","py-2"],[1,"modal-title"],["type","button","aria-label","Close",3,"click"],["aria-hidden","true"],[1,"container","p-3"],[1,"modal-footer","py-1"],[1,"mb-2","mx-2","btn","btn-outline-danger",3,"click"]],template:function(e,t){1&e&&(o.\u0275\u0275template(0,P,2,1,"div",0),o.\u0275\u0275pipe(1,"async")),2&e&&o.\u0275\u0275property("ngIf",o.\u0275\u0275pipeBind1(1,1,t.loanSharedService.ibDocumentsReceived))},directives:[y.NgIf,y.NgClass,y.NgForOf,T.oH,r._Y,r.JL,r.sg,T.MU,r.Fj,r.JJ,r.u,w.Lv,r.F],pipes:[y.AsyncPipe,I.X$,y.DatePipe],styles:[""]}),e})()},49994:function(e,t,n){n.d(t,{F:function(){return K}});var i=n(8239),o=n(37716),l=n(15694),r=n(98642),a=n(31900),s=n(3679),d=n(58762),c=n(79765),u=n(67757),p=n(16519),m=n(30165),f=n(30023),h=n(22134),g=n(64380),v=n(85627),y=n(99266),S=n(65981),x=n(25465),C=n(54798),b=n(39577),E=n(38583),I=n(57552),L=n(29790);function F(e,t){1&e&&o.\u0275\u0275element(0,"hr",15)}function D(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"option",23),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;o.\u0275\u0275property("ngValue",e),o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate1(" ",e.description," ")}}function T(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"button",24),o.\u0275\u0275listener("click",function(){o.\u0275\u0275restoreView(e);const t=o.\u0275\u0275nextContext(2).index;return o.\u0275\u0275nextContext(2).deleteGroupLoan(t)}),o.\u0275\u0275element(1,"i",25),o.\u0275\u0275elementEnd()}}function w(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"div",16),o.\u0275\u0275elementStart(1,"label"),o.\u0275\u0275text(2),o.\u0275\u0275pipe(3,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(4,"div",17),o.\u0275\u0275elementStart(5,"div",18),o.\u0275\u0275elementStart(6,"select",19),o.\u0275\u0275listener("change",function(){o.\u0275\u0275restoreView(e);const t=o.\u0275\u0275nextContext().index;return o.\u0275\u0275nextContext(2).getUdfFiledListLoan(t,!1)}),o.\u0275\u0275template(7,D,2,2,"option",20),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(8,"div",21),o.\u0275\u0275template(9,T,2,0,"button",22),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()}if(2&e){const e=o.\u0275\u0275nextContext().index,t=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate1("",o.\u0275\u0275pipeBind1(3,6,"udf.udf_group")," "),o.\u0275\u0275advance(4),o.\u0275\u0275propertyInterpolate1("formControlName","udfGroup",e,""),o.\u0275\u0275property("compareWith",t.comparegroup),o.\u0275\u0275attribute("disabled",t.udfGroupsSelected[e].mondatory?"":null),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngForOf",t.udfGroups),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",!t.udfGroupsSelected[e].mondatory)}}function O(e,t){1&e&&(o.\u0275\u0275elementStart(0,"span",31),o.\u0275\u0275text(1," *"),o.\u0275\u0275elementEnd())}function k(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275elementStart(1,"label"),o.\u0275\u0275text(2),o.\u0275\u0275template(3,O,2,0,"span",30),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext().$implicit;o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate1(" ",e.description," "),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",e.mandatory)}}function G(e,t){1&e&&(o.\u0275\u0275elementStart(0,"small",31),o.\u0275\u0275text(1),o.\u0275\u0275pipe(2,"translate"),o.\u0275\u0275elementEnd()),2&e&&(o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate1("",o.\u0275\u0275pipeBind1(2,1,"This_field_is_required"),"."))}function R(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275template(1,G,3,3,"small",30),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext(2).index,t=o.\u0275\u0275nextContext(2).index,n=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",null==n.udfLoanForm.get("udfField"+t+e).errors?null:n.udfLoanForm.get("udfField"+t+e).errors.required)}}function _(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275element(1,"input",32),o.\u0275\u0275template(2,R,2,1,"div",14),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext().index,t=o.\u0275\u0275nextContext(2).index,n=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(1),o.\u0275\u0275propertyInterpolate2("formControlName","udfField",t,"",e,""),o.\u0275\u0275property("placeholder",n.mascPlacHolder(n.udfFieldsLoan[t][e].fieldMasc)),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",n.udfLoanForm.get("udfField"+t+e).touched&&n.udfLoanForm.get("udfField"+t+e).invalid)}}function A(e,t){1&e&&(o.\u0275\u0275elementStart(0,"small",31),o.\u0275\u0275text(1),o.\u0275\u0275pipe(2,"translate"),o.\u0275\u0275elementEnd()),2&e&&(o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate1("",o.\u0275\u0275pipeBind1(2,1,"This_field_is_required"),"."))}function V(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275template(1,A,3,3,"small",30),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext(2).index,t=o.\u0275\u0275nextContext(2).index,n=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",null==n.udfLoanForm.get("udfField"+t+e).errors?null:n.udfLoanForm.get("udfField"+t+e).errors.required)}}function N(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275element(1,"input",33),o.\u0275\u0275template(2,V,2,1,"div",14),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext().index,t=o.\u0275\u0275nextContext(2).index,n=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(1),o.\u0275\u0275propertyInterpolate2("formControlName","udfField",t,"",e,""),o.\u0275\u0275property("placeholder",n.mascPlacHolder(n.udfFieldsLoan[t][e].fieldMasc)),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",n.udfLoanForm.get("udfField"+t+e).touched&&n.udfLoanForm.get("udfField"+t+e).invalid)}}function U(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"option",23),o.\u0275\u0275text(1),o.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;o.\u0275\u0275property("ngValue",e),o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate1(" ",e.description," ")}}function M(e,t){1&e&&(o.\u0275\u0275elementStart(0,"small",31),o.\u0275\u0275text(1),o.\u0275\u0275pipe(2,"translate"),o.\u0275\u0275elementEnd()),2&e&&(o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate1("",o.\u0275\u0275pipeBind1(2,1,"This_field_is_required"),"."))}function B(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275template(1,M,3,3,"small",30),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext(2).index,t=o.\u0275\u0275nextContext(2).index,n=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",null==n.udfLoanForm.get("udfField"+t+e).errors?null:n.udfLoanForm.get("udfField"+t+e).errors.required)}}function P(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275elementStart(1,"select",34),o.\u0275\u0275listener("change",function(){o.\u0275\u0275restoreView(e);const t=o.\u0275\u0275nextContext().index,n=o.\u0275\u0275nextContext(2).index;return o.\u0275\u0275nextContext(2).changeUDFField(n,t)}),o.\u0275\u0275elementStart(2,"option",35),o.\u0275\u0275text(3),o.\u0275\u0275pipe(4,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(5,U,2,2,"option",20),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(6,B,2,1,"div",14),o.\u0275\u0275elementEnd()}if(2&e){const e=o.\u0275\u0275nextContext(),t=e.index,n=e.$implicit,i=o.\u0275\u0275nextContext(2).index,l=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(1),o.\u0275\u0275property("formControlName","udfField"+i+t)("compareWith",l.compareFieldUDF),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(4,5,"udf.udf_group_code_default_select")," "),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngForOf",n.fieldListValuesDTOs),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",l.udfLoanForm.get("udfField"+i+t).touched&&l.udfLoanForm.get("udfField"+i+t).invalid)}}function j(e,t){1&e&&(o.\u0275\u0275elementStart(0,"small",31),o.\u0275\u0275text(1),o.\u0275\u0275pipe(2,"translate"),o.\u0275\u0275elementEnd()),2&e&&(o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate1("",o.\u0275\u0275pipeBind1(2,1,"This_field_is_required"),"."))}function J(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275template(1,j,3,3,"small",30),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext(2).index,t=o.\u0275\u0275nextContext(2).index,n=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",null==n.udfLoanForm.get("udfField"+t+e).errors?null:n.udfLoanForm.get("udfField"+t+e).errors.required)}}function z(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275element(1,"input",36),o.\u0275\u0275template(2,J,2,1,"div",14),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext().index,t=o.\u0275\u0275nextContext(2).index,n=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(1),o.\u0275\u0275propertyInterpolate2("formControlName","udfField",t,"",e,""),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",n.udfLoanForm.get("udfField"+t+e).touched&&n.udfLoanForm.get("udfField"+t+e).invalid)}}function q(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div",29),o.\u0275\u0275template(1,k,4,2,"div",14),o.\u0275\u0275template(2,_,3,4,"div",14),o.\u0275\u0275template(3,N,3,4,"div",14),o.\u0275\u0275template(4,P,7,7,"div",14),o.\u0275\u0275template(5,z,3,3,"div",14),o.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",!e.delete),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",!e.delete&&1===e.fieldType),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",!e.delete&&2===e.fieldType),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",!e.delete&&5===e.fieldType),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",!e.delete&&4===e.fieldType)}}function H(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275elementStart(1,"div",26),o.\u0275\u0275elementStart(2,"div",27),o.\u0275\u0275elementStart(3,"div",17),o.\u0275\u0275template(4,q,6,5,"div",28),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext().index,t=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(4),o.\u0275\u0275property("ngForOf",t.udfFieldsLoan[e])}}function Y(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275template(1,F,1,0,"hr",12),o.\u0275\u0275template(2,w,10,8,"div",13),o.\u0275\u0275template(3,H,5,1,"div",14),o.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=t.index,i=o.\u0275\u0275nextContext(2);o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",e.enabled),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",e.enabled),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",(null==i.udfFieldsLoan[n]?null:i.udfFieldsLoan[n].length)>0&&e.enabled&&i.udfFormData)}}function W(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"div",1),o.\u0275\u0275elementStart(1,"div",2),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(e),o.\u0275\u0275nextContext().toggleCollapseCustomerAnalyses()}),o.\u0275\u0275elementStart(2,"div"),o.\u0275\u0275element(3,"i",3),o.\u0275\u0275text(4),o.\u0275\u0275pipe(5,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(6,"div"),o.\u0275\u0275element(7,"i",4),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(8,"div",5),o.\u0275\u0275elementStart(9,"div",6),o.\u0275\u0275elementStart(10,"div",7),o.\u0275\u0275elementStart(11,"button",8),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(e),o.\u0275\u0275nextContext().addUdfLoan()}),o.\u0275\u0275element(12,"fa-icon",9),o.\u0275\u0275text(13),o.\u0275\u0275pipe(14,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(15,"form",10),o.\u0275\u0275template(16,Y,4,3,"div",11),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()}if(2&e){const e=o.\u0275\u0275nextContext();o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(5,7,"loan_management.field_analysis")," "),o.\u0275\u0275advance(3),o.\u0275\u0275property("ngClass",!0===e.expandedUdf?"lnr-chevron-up text-secondary":"lnr-chevron-down text-secondary"),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngClass",!0===e.expandedUdf?"collapse show":"collapse"),o.\u0275\u0275advance(4),o.\u0275\u0275property("icon",e.library.getIconDefinition("fas","plus")),o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(14,9,"button.add")," "),o.\u0275\u0275advance(2),o.\u0275\u0275property("formGroup",e.udfLoanForm),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngForOf",e.udfGroupsSelected)}}let K=(()=>{class e{constructor(e,t,n,i,r,a,s){this.devToolsServices=e,this.activatedRoute=t,this.formBuilder=n,this.sharedService=i,this.dbService=r,this.udfService=a,this.library=s,this.expandedUdf=!0,this.udfGroups=[],this.udfGroupsSelected=[],this.maxIndexGroup=0,this.show=new c.xQ,this.udfGroupLoan=new l.t,this.udfLinkGroupLoan=[],this.udfLinks=[],this.udfFieldsLoan=[],this.indexFormUdfLoan=0,this.loan=new m.t,this.udfList=new o.EventEmitter,this.validationUdfEmitter=new o.EventEmitter,this.udfFormData=!1}ngOnChanges(e){e?.getUdfList?.currentValue!==e?.getUdfList?.previousValue&&void 0!==e?.getUdfList?.previousValue&&this.udfList.next(this.onSubmitElement()),e?.saveUdf?.currentValue!==e?.saveUdf?.previousValue&&void 0!==e?.saveUdf?.previousValue&&this.saveUdfLinks()}ngOnInit(){var e=this;return(0,i.Z)(function*(){yield e.activatedRoute.queryParams.subscribe(t=>{e.mode=t.source}),e.isCollection=e.category===d.J.COLLECTION_CATEGORY,e.udfLoanForm=null,e.udfGroupsSelected=[],e.udfGroups=[],e.maxIndexGroup=0,e.indexFormUdfLoan=0,e.udfLoanForm=e.formBuilder.group({}),e.maxIndexGroup=0,e.loan=e.sharedService.getLoan(),yield e.getUdfAllGroupLoan(),"add"!=e.source&&(yield e.getUdfLoanInformation());for(let t=0;t<e.udfGroups.length;t++)if(!0===e.udfGroups[t].mondatory)if(void 0===e.udfGroupsSelected.find(n=>n.id===e.udfGroups[t].id))e.udfGroupsSelected.push(e.udfGroups[t]),e.udfLoanForm.addControl("udfGroup"+e.indexFormUdfLoan,new s.NI("",s.kI.required)),e.udfLoanForm.controls["udfGroup"+e.indexFormUdfLoan].setValue(e.udfGroups[t]),yield e.getUdfFiledListLoan(e.indexFormUdfLoan,!0),e.indexFormUdfLoan++;else{let n=e.devToolsServices.findFormControlWithValue(e.udfGroups[t].code,e.udfLoanForm);e.udfGroupsSelected[n].mondatory=!0}})()}getUdfLoanInformation(){var e=this;return(0,i.Z)(function*(){e.udfFieldsLoan[0]=[];const t=new r.l;if(t.category=e.category,e.category===d.J.CUSTOMER_CATEGORY_CUSTOMER&&(t.elementId=e.sharedService.getCustomer()?.id),e.category===d.J.COLLATERAL_CATEGORY&&(t.elementId=e.sharedService.getCollateral()?.idAcmCollateral),e.category===d.J.LOAN_CATEGORY?t.elementId=e.loan.loanId:e.category===d.J.COLLECTION_CATEGORY?t.elementId=e.sharedService.getCollection().id:e.category===d.J.SUPPLIER_CATEGORY?t.elementId=e.sharedService.getSupplier().id:e.category===d.J.PARTY_CATEGORY?t.elementId=e.sharedService.getThirdParty().id:e.category===d.J.ITEM_CATEGORY?t.elementId=e.sharedService.getItem().id:e.category===d.J.PROSPECT_CATEGORY&&(t.category=d.J.CUSTOMER_CATEGORY_CUSTOMER,t.elementId=e.sharedService.getCustomer().id),t.udfGroupIds=e.udfGroups.map(e=>e.id),(0,h.L0)()||"preview"===e.mode){const t=e.isCollection?"getUdfLinkGroupLoanByCollectionId_"+e.sharedService.getCollection().id:e.category===d.J.LOAN_CATEGORY?"getUdfLinkGroupLoanByLoanId_"+e.loan.loanId:"getUdfLinkGroupLoanByCollateralId_"+e.sharedService.getCollateral()?.idAcmCollateral;yield e.dbService.getByKey("data",t).toPromise().then(t=>{if(void 0===t||0==t?.data?.length)if(e.sharedService.getCollateral()?.userDefinedFieldsLinksDTOs){let t=[];e.sharedService.getCollateral()?.userDefinedFieldsLinksDTOs.forEach(e=>{t.includes(e.userDefinedFieldsDTO.userDefinedFieldGroupDTO.id)||t.push(e.userDefinedFieldsDTO.userDefinedFieldGroupDTO.id)});let n=[...e.udfGroups];n=n.filter(e=>t.some(t=>t===e.id)?e:null);const i=(0,h.Zu)(e.sharedService.getCollateral()?.userDefinedFieldsLinksDTOs,n,null);e.udfLinkGroupLoan=i}else e.devToolsServices.openToast(3,"No Udf Link Group Loan saved for offline use");else e.udfLinkGroupLoan=t.data})}else yield e.udfService.getUdfLinkGroupby(t).toPromise().then(t=>e.udfLinkGroupLoan=t);if(e.udfLinkGroupLoan.forEach(t=>{t.udfGroupeFieldsModels.forEach(t=>{t.indexGroup>=e.maxIndexGroup&&(e.maxIndexGroup=t.indexGroup+1)})}),(0,h.L0)()||"preview"===e.mode){const t=e.isCollection?"getMaxIndexGroupByCollectionId_"+e.sharedService.getCollection().id:e.category===d.J.LOAN_CATEGORY?"getMaxIndexGroupByLoanId_"+e.loan.loanId:"getMaxIndexGroupByCollateralId_"+e.sharedService.getCollateral()?.idAcmCollateral;yield e.dbService.getByKey("data",t).toPromise().then(t=>{t&&(e.maxIndexGroup=t.data+1)})}else yield e.udfService.findMaxIndexGroup(t.elementId,t.category).toPromise().then(t=>{e.maxIndexGroup=t+1});let n=0;e.udfLinkGroupLoan.forEach(t=>{if(void 0!==e.udfGroups.find(e=>e.id===t.userDefinedFieldGroupID)){const i=new l.t;i.id=t.userDefinedFieldGroupID,i.enabled=!0,i.indexGroup=n,i.code=t.userDefinedFieldGroupName,e.udfLoanForm.addControl("udfGroup"+e.indexFormUdfLoan,new s.NI(i)),e.udfGroupsSelected.push(i),e.indexFormUdfLoan++,n++}});for(let i=0;i<e.udfGroupsSelected.length;i++)yield e.getUdfGroupLoan(i)})()}getUdfAllGroupLoan(){var e=this;return(0,i.Z)(function*(){let t=new f.d;if("workflow"===e.source)if((0,h.L0)()||"preview"===e.mode){const t=e.isCollection?"getUdfGroupsByIdCollectionStep_"+e.sharedService.getCollection().idAcmCollectionStep:"getUdfGroupsByLoanWorkflowStep_"+e.sharedService.currentStatus;yield e.dbService.getByKey("data",t).toPromise().then(t=>{void 0===t?e.devToolsServices.openToast(3,"No Udf Groups saved for offline use"):e.udfGroups=t.data})}else e.category===d.J.LOAN_CATEGORY?t.idWorkflowStep=e.sharedService.currentStatus:e.category===d.J.COLLECTION_CATEGORY?t.idCollectionStep=e.sharedService.getCollection().idAcmCollectionStep:e.category===d.J.ITEM_CATEGORY&&(t.idWorkflowStep=e.sharedService.getItem().actualStep),yield e.udfService.findUdfGroupsByStepId(t).toPromise().then(t=>{e.udfGroups=t});else if("add"===e.source||"edit"===e.source)if((0,h.L0)())yield e.dbService.getByKey("data","getUdfGroup_"+e.category).toPromise().then(t=>{void 0!==t&&(e.udfGroups=t.data)});else{let t=new l.t;t.category=e.category,yield e.udfService.getUdfGroup(t).toPromise().then(t=>{e.udfGroups=t})}})()}getUdfGroupLoan(e){var t=this;return(0,i.Z)(function*(){yield t.getUdfFiledListLoan(e,!0)})()}getUdfFiledListLoan(e,t){var n=this;return(0,i.Z)(function*(){if(n.udfFormData=!1,!t)for(let t=0;t<n.udfFieldsLoan[e].length;t++)n.udfLoanForm.controls["udfField"+e+t].reset(),n.udfLoanForm.controls["udfField"+e+t].clearValidators();let i;if(n.udfFieldsLoan[e]=[],i=t?n.udfGroupsSelected[e].id:n.udfLoanForm.controls["udfGroup"+e].value.id,"workflow"===n.source)if((0,h.L0)()||"preview"===n.mode){const t=n.isCollection?"getUdfFieldsByIdCollectionStep_"+n.sharedService.getCollection().idAcmCollectionStep:"getUdfFieldsByIdLoanStep_"+n.sharedService.currentStatus;yield n.dbService.getByKey("data",t).toPromise().then(t=>{void 0===t?n.devToolsServices.openToast(3,"No Udf Fields Loan saved for offline use"):n.udfFieldsLoan[e]=t.data})}else{let t=new f.d;n.category===d.J.LOAN_CATEGORY?t.idWorkflowStep=n.sharedService.currentStatus:n.category===d.J.COLLECTION_CATEGORY?t.idCollectionStep=n.sharedService.getCollection().idAcmCollectionStep:n.category===d.J.ITEM_CATEGORY&&(t.idWorkflowStep=n.sharedService.getItem().actualStep);const o=yield n.udfService.findUdfFieldsByStepId(t,i).toPromise();n.udfFieldsLoan[e]=o}else if("add"===n.source||"edit"===n.source)if((0,h.L0)())yield n.dbService.getByKey("data","udf-fields-group-id-"+i).toPromise().then(t=>{void 0!==t&&(n.udfFieldsLoan[e]=t.data)});else{let t=new a.x;t.userDefinedFieldGroupDTO=new l.t,t.userDefinedFieldGroupDTO.id=i;const o=yield n.udfService.getUdfField(t).toPromise();n.udfFieldsLoan[e]=o}if(n.udfFieldsLoan[e].filter(e=>0!==e.idUDFParentField).map(e=>e.fieldListValuesDTOs=[]),"add"===n.source)for(let t=0;t<n.udfFieldsLoan[e].length;t++)!0===n.udfFieldsLoan[e][t].mandatory?n.udfLoanForm.addControl("udfField"+e+t,new s.NI("",[s.kI.required,s.kI.pattern(n.udfFieldsLoan[e][t].fieldMasc)])):!1===n.udfFieldsLoan[e][t].mandatory&&n.udfLoanForm.addControl("udfField"+e+t,new s.NI("",s.kI.pattern(n.udfFieldsLoan[e][t].fieldMasc)));else if("edit"===n.source||"workflow"===n.source){n.udfGroupLoan=n.udfGroupsSelected[e];let i,o=new u.O;o.udfGroupeFieldsModels=[],t?null!=n.udfGroupLoan.indexGroup&&(o=n.udfLinkGroupLoan[n.udfGroupLoan.indexGroup]):n.udfLinkGroupLoan.forEach(e=>{e.userDefinedFieldGroupID===n.udfGroupLoan.id&&(o=e)});for(let l=0;l<n.udfFieldsLoan[e].length;l++){i=!1;for(const t of o.udfGroupeFieldsModels)if(n.surveysId=t.surveysId,t.udfFieldID===n.udfFieldsLoan[e][l].id)if(n.udfFieldsLoan[e][l].idAbacusUDFLink=t.idAbacusUDFLink,n.udfFieldsLoan[e][l].surveysId=t.surveysId,n.udfFieldsLoan[e][l].idUDFLink=t.id,n.udfFieldsLoan[e][l].delete=!1,5===n.udfFieldsLoan[e][l].fieldType)for(const o of n.udfFieldsLoan[e][l].fieldListValuesDTOs)o.description.toUpperCase()===t.value.toUpperCase()&&(n.udfLoanForm.addControl("udfField"+e+l,!0===n.udfFieldsLoan[e][l].mandatory?new s.NI(o,s.kI.required):new s.NI(o)),i=!0,yield n.changeUDFField(e,l));else n.udfLoanForm.addControl("udfField"+e+l,new s.NI(t.value,!0===n.udfFieldsLoan[e][l].mandatory?[s.kI.required,s.kI.pattern(n.udfFieldsLoan[e][l].fieldMasc)]:s.kI.pattern(n.udfFieldsLoan[e][l].fieldMasc))),i=!0;i||(t&&(n.udfFieldsLoan[e][l].surveysId=n.surveysId),n.udfLoanForm.addControl("udfField"+e+l,new s.NI("",!0===n.udfFieldsLoan[e][l].mandatory?[s.kI.required,s.kI.pattern(n.udfFieldsLoan[e][l].fieldMasc)]:s.kI.pattern(n.udfFieldsLoan[e][l].fieldMasc))))}}n.udfFormData=!0})()}addUdfLoan(){const e=new l.t;e.enabled=!0,e.code=null,this.udfGroupsSelected.push(e),this.udfFieldsLoan[this.udfGroupsSelected.length-1]=[],this.udfLoanForm.addControl("udfGroup"+this.indexFormUdfLoan,new s.NI("")),this.indexFormUdfLoan++}toggleCollapseCustomerAnalyses(){this.expandedUdf=!this.expandedUdf}saveUdfLinks(){var e=this;return(0,i.Z)(function*(){if(e.onSubmitElement(),e.udfLoanForm.invalid)return e.validationUdfEmitter.emit(!0),void e.devToolsServices.InvalidControl();if(e.validationUdfEmitter.emit(!1),e.udfLinks.length>0)if((0,h.L0)()){e.category===d.J.COLLECTION_CATEGORY&&(yield e.dbService.update("udfLinks",{elementId:e.udfLinks[0].elementId,udfLink:e.udfLinks}).toPromise().then(()=>{e.devToolsServices.openToast(0,"alert.success")})),e.udfGroups.forEach(function(){var t=(0,i.Z)(function*(t){let n=[];e.udfLinks.filter(e=>e.userDefinedFieldsDTO.userDefinedFieldGroupDTO.id===t.id).forEach(e=>{let t=new g.m;if(t.value=e.fieldValue,t.indexGroup=e.indexGroup,t.fieldName=e.userDefinedFieldsDTO.name,t.udfFieldID=e.userDefinedFieldsDTO.id,t.mandatory=e.userDefinedFieldsDTO.mandatory,t.mask=e.userDefinedFieldsDTO.fieldMasc,5===e.userDefinedFieldsDTO.fieldType){const n=e.userDefinedFieldsDTO.fieldListValuesDTOs.filter(t=>t.idUDFListValue.toString()===e.fieldValue.toString());n.length>0&&(t.value=n[0].name)}n.push(t)}),e.udfLinkGroupLoan.filter(e=>e.userDefinedFieldGroupID===t.id)[0].udfGroupeFieldsModels=n});return function(e){return t.apply(this,arguments)}}());const t=e.getKey();e.dbService.update("data",{id:t,data:e.udfLinkGroupLoan}).toPromise().then(()=>{e.devToolsServices.openToast(0,"alert.success")},e=>console.error("Error saving data:",e))}else e.udfService.updateUdfLinksByElementId(e.udfLinks,e.udfLinks[0].elementId).subscribe(()=>{e.devToolsServices.backTop(),e.devToolsServices.openToast(0,"alert.success"),e.ngOnInit()})})()}onSubmitElement(){if(this.devToolsServices.makeFormAsTouched(this.udfLoanForm),this.udfLoanForm.invalid?(this.validationUdfEmitter.emit(!0),this.devToolsServices.InvalidControl()):this.validationUdfEmitter.emit(!1),this.udfLinks=[],this.udfGroupsSelected.length>=0)for(let e=0;e<this.udfGroupsSelected.length;e++){for(let t=0;t<this.udfFieldsLoan[e].length;t++){const n=new r.l;this.category===d.J.LOAN_CATEGORY?n.elementId=this.loan.loanId:this.category===d.J.COLLECTION_CATEGORY?n.elementId=this.sharedService.getCollection().id:this.category===d.J.ITEM_CATEGORY&&(n.elementId=this.sharedService.getItem().id),n.category=this.category!==d.J.PROSPECT_CATEGORY?this.category:d.J.CUSTOMER_CATEGORY_CUSTOMER,n.idAbacusUDFLink=this.udfFieldsLoan[e][t].idAbacusUDFLink,n.surveysId=this.udfFieldsLoan[e][t].surveysId,n.id=this.udfFieldsLoan[e][t].idUDFLink,this.udfFieldsLoan[e][t].delete?void 0!==n.idAbacusUDFLink&&void 0!==n.surveysId&&(n.fieldValue=""):5===this.udfFieldsLoan[e][t].fieldType?(n.fieldValue=this.udfLoanForm.controls["udfField"+e+t].value?.idUDFListValue,n.udfListValueId=this.udfLoanForm.controls["udfField"+e+t].value?.idUDFListLink):n.fieldValue=this.udfLoanForm.controls["udfField"+e+t].value,8===this.udfFieldsLoan[e][t].userDefinedFieldGroupDTO.id&&this.udfFieldsLoan[e][t].fieldListValuesDTOs.forEach(n=>{n.idUDFListValue.toString(),this.udfLoanForm.controls["udfField"+e+t].value.toString()}),n.userDefinedFieldsDTO=this.udfFieldsLoan[e][t],n.indexGroup=this.maxIndexGroup,this.udfLinks.push(n)}this.maxIndexGroup++}return this.udfLinks}getKey(){switch(this.category){case d.J.COLLECTION_CATEGORY:return"getUdfLinkGroupLoanByCollectionId_"+this.sharedService.getCollection().id;case d.J.COLLATERAL_CATEGORY:return"getUdfLinkGroupLoanByCollateralId_"+this.sharedService.getCollateral()?.idAcmCollateral}}mascPlacHolder(e){if(""!==e){e=new RegExp(e);let t=0;e.source.match(/\d+/g).map(Number).forEach(e=>{t=e});let n="";for(let e=1;e<=t;e++)n+="x";return n}return""}comparegroup(e,t){if(void 0!==e&&void 0!==t)return e.id===t.id}deleteGroupLoan(e){this.udfGroupsSelected[e].enabled=!1,this.udfFieldsLoan[e].forEach(e=>{e.delete=!0})}changeUDFField(e,t){var n=this;return(0,i.Z)(function*(){const i=n.udfFieldsLoan[e][t];for(let o=0;o<n.udfFieldsLoan[e].length;o++)if(n.udfFieldsLoan[e][o].idUDFParentField===i.id)if((0,h.L0)())yield n.dbService.getByKey("data","udf-fields-group-id-"+n.udfFieldsLoan[e][o].userDefinedFieldGroupDTO.id).toPromise().then(i=>{if(void 0!==i){const l=i.data?.filter(t=>t.id===n.udfFieldsLoan[e][o].id);if(l.length>0){let i=l[0].fieldListValuesDTOs;i=i.filter(i=>i.parentUDFListValue===n.udfLoanForm.controls["udfField"+e+t].value.id),n.udfFieldsLoan[e][o].fieldListValuesDTOs=i}}});else{const i=new p.X;i.parentUDFListValue=n.udfLoanForm.controls["udfField"+e+t].value.id,yield n.udfService.getUdfListValue(i).toPromise().then(t=>{n.udfFieldsLoan[e][o].fieldListValuesDTOs=t})}})()}compareFieldUDF(e,t){return void 0!==t&&void 0!==e&&null!==t&&null!==e&&void 0!==t.idUDFListValue&&void 0!==e.idUDFListValue&&null!==t.idUDFListValue&&null!==e.idUDFListValue&&e.idUDFListValue===t.idUDFListValue}}return e.\u0275fac=function(t){return new(t||e)(o.\u0275\u0275directiveInject(v.R),o.\u0275\u0275directiveInject(y.gz),o.\u0275\u0275directiveInject(s.qu),o.\u0275\u0275directiveInject(S.F),o.\u0275\u0275directiveInject(x.ys),o.\u0275\u0275directiveInject(C.H),o.\u0275\u0275directiveInject(b.by))},e.\u0275cmp=o.\u0275\u0275defineComponent({type:e,selectors:[["app-udf-step-workflow"]],inputs:{expanded:"expanded",category:"category",source:"source",getUdfList:"getUdfList",saveUdf:"saveUdf"},outputs:{udfList:"udfList",validationUdfEmitter:"validationUdfEmitter"},features:[o.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[["class","card-hover-shadow-2x mb-1 card",4,"ngIf"],[1,"card-hover-shadow-2x","mb-1","card"],["data-target","#collapseLoanAnalyses","aria-expanded","true","aria-controls","collapseCustomerAccount",1,"card-header","d-flex","justify-content-between",3,"click"],[1,"lnr-magnifier","text-secondary","pr-2"],[3,"ngClass"],["aria-labelledby","headingOne","data-parent","#accordionExample",3,"ngClass"],[1,"card-body"],[1,"col-xl-12","d-flex","justify-content-end","pt-3"],["type","button",1,"btn-shadow","d-inline-flex","align-items-center","btn","btn-primary",3,"click"],[1,"mx-2",3,"icon"],[3,"formGroup"],[4,"ngFor","ngForOf"],["class","solid",4,"ngIf"],["class","position-relative form-group",4,"ngIf"],[4,"ngIf"],[1,"solid"],[1,"position-relative","form-group"],[1,"row"],[1,"col-xl-6"],["name","udfGroup",1,"form-control",3,"formControlName","compareWith","change"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-xl-6","px-3"],["class","btn btn-danger",3,"click",4,"ngIf"],[3,"ngValue"],[1,"btn","btn-danger",3,"click"],[1,"pe-7s-trash","btn-icon-wrapper","text-white"],[1,"table-responsive","mt-2"],[1,"container"],["class","col-xl-4 col-md-4 mb-3",4,"ngFor","ngForOf"],[1,"col-xl-4","col-md-4","mb-3"],["class","text-danger",4,"ngIf"],[1,"text-danger"],["type","text","name","udfField",1,"form-control",3,"placeholder","formControlName"],["type","number","name","udfField",1,"form-control",3,"placeholder","formControlName"],["name","udfField",1,"form-control",3,"formControlName","compareWith","change"],["selected","","value",""],["type","date","name","udfField",1,"form-control",3,"formControlName"]],template:function(e,t){1&e&&o.\u0275\u0275template(0,W,17,11,"div",0),2&e&&o.\u0275\u0275property("ngIf",t.udfGroups.length>0)},directives:[E.NgIf,E.NgClass,b.BN,s._Y,s.JL,s.sg,I.MU,E.NgForOf,I.HK,s.EJ,I.oH,s.JJ,s.u,s.YN,s.Kr,s.Fj,s.wV],pipes:[L.X$],styles:[""]}),e})()},99738:function(e,t,n){n.d(t,{r:function(){return r}});var i=n(6452),o=n(37716),l=n(91841);let r=(()=>{class e{constructor(e){this.httpClient=e}getProducts(e){return this.httpClient.post(i.f.PRODUCT_DETAILS,e)}findBranche(){return this.httpClient.get(i.f.BRANCHE_FIND)}findAllPortfolio(e){return this.httpClient.post(i.f.FIND_PORTFOLIO,e)}loadFilterStatusWorkflow(){return this.httpClient.get(i.f.LOAD_STATUS_WORKFLOW)}reportingLoanApplication(e){return this.httpClient.post(i.f.REPORTING_LOAN_APPLICATION,e,{responseType:"blob"})}reportingExcelCollectionFollowupReport(e){return this.httpClient.post(i.f.REPORTING_COLLECTION_FOLLOW_UP,e,{responseType:"blob"})}getLoanSourceOfFunds(){return this.httpClient.get(i.f.LOAD_SOURCE_OF_FUNDS)}loadFilterStatusABACUS(){return this.httpClient.get(i.f.LOAD_STATUS_ABACUS)}reportingAml(e){return this.httpClient.post(i.f.REPORTING_AML,e,{responseType:"blob"})}createFilter(e){return this.httpClient.post(i.f.CREATE_FILTRE,e)}findListFilter(e){return this.httpClient.post(i.f.FIND_FILTRE,e)}reportingExcelMezaCard(e){return this.httpClient.post(i.f.REPORTING_MEZA_CARD,e,{responseType:"blob"})}saveReportingSetting(e){return this.httpClient.post(i.f.SAVE_REPORTING_SETTING,e)}findReportingSetting(e){return this.httpClient.post(i.f.FIND_REPORTING_SETTING,e)}generateExcelReport(e){return this.httpClient.post(i.f.GENERATE_EXCEL_REPORT,e,{responseType:"blob"})}generatePdfReport(e){return this.httpClient.post(i.f.GENERATE_PDF_REPORT,e,{responseType:"blob"})}findReportData(e){return this.httpClient.post(i.f.FIND_REPORT_DATA,e)}}return e.\u0275fac=function(t){return new(t||e)(o.\u0275\u0275inject(l.eN))},e.\u0275prov=o.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},17420:function(e,t,n){n.d(t,{g:function(){return r}});var i=n(6452),o=n(37716),l=n(91841);let r=(()=>{class e{constructor(e){this.httpClient=e}saveGlAccount(e){return this.httpClient.post(i.f.SAVE_GL_ACCOUNT,e)}findGlAccount(e){return this.httpClient.post(i.f.FIND_GL_ACCOUNT,e)}findPaginationGlAccount(e){return this.httpClient.post(i.f.FIND_PAGINATION_GL_ACCOUNT,e)}findPaginationJournal(e){return this.httpClient.post(i.f.FIND_PAGINATION_ACM_JOURNAL,e)}generateJournalExcelReport(e){return this.httpClient.post(i.f.GENERATE_ACM_JOURNAL_EXCEL_REPORT,e,{responseType:"blob"})}}return e.\u0275fac=function(t){return new(t||e)(o.\u0275\u0275inject(l.eN))},e.\u0275prov=o.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},24088:function(e,t,n){n.d(t,{u:function(){return O}});var i=n(8239),o=n(37716),l=n(43073),r=n(55041),a=n(30165),s=n(58762),d=n(72114),c=n(28970),u=n(38583),p=n(88075),m=n(85627),f=n(65981),h=n(37300),g=n(3679),v=n(61181),y=n(29790),S=n(23990),x=n(70946);function C(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"button",23),o.\u0275\u0275listener("click",function(){o.\u0275\u0275restoreView(e);const t=o.\u0275\u0275nextContext().$implicit;return o.\u0275\u0275nextContext(2).downloadTemplate(t)}),o.\u0275\u0275element(1,"i",27),o.\u0275\u0275elementEnd()}}function b(e,t){1&e&&(o.\u0275\u0275elementStart(0,"span",28),o.\u0275\u0275text(1,"*"),o.\u0275\u0275elementEnd())}function E(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"p"),o.\u0275\u0275text(1),o.\u0275\u0275pipe(2,"date"),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext().$implicit;o.\u0275\u0275advance(1),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind2(2,1,e.dateDebut,"dd/MM/yyyy")," ")}}function I(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"tr"),o.\u0275\u0275elementStart(1,"td"),o.\u0275\u0275template(2,C,2,0,"button",14),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(3,"td"),o.\u0275\u0275text(4),o.\u0275\u0275template(5,b,2,0,"span",15),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(6,"td"),o.\u0275\u0275text(7),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(8,"td"),o.\u0275\u0275template(9,E,3,4,"p",6),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(10,"td",16),o.\u0275\u0275elementStart(11,"button",17),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(e),o.\u0275\u0275reference(15).click()}),o.\u0275\u0275elementStart(12,"fa",18),o.\u0275\u0275element(13,"i",19),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(14,"input",20,21),o.\u0275\u0275listener("change",function(t){const n=o.\u0275\u0275restoreView(e).index;return o.\u0275\u0275nextContext(2).onUpload(t,n)}),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(16,"td",22),o.\u0275\u0275elementStart(17,"button",23),o.\u0275\u0275listener("click",function(){const t=o.\u0275\u0275restoreView(e).$implicit,n=o.\u0275\u0275nextContext(2),i=o.\u0275\u0275reference(13);return n.openLarge(i,t)}),o.\u0275\u0275element(18,"i",24),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(19,"td",16),o.\u0275\u0275elementStart(20,"button",25),o.\u0275\u0275listener("click",function(){const t=o.\u0275\u0275restoreView(e).$implicit;return o.\u0275\u0275nextContext(2).view(t.file,t.idDocumentGED)}),o.\u0275\u0275element(21,"i",26),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",e.reportName&&""!==e.reportName),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(e.code),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",e.mandatory),o.\u0275\u0275advance(2),o.\u0275\u0275textInterpolate(e.name),o.\u0275\u0275advance(2),o.\u0275\u0275property("ngIf",e.idDocumentGED),o.\u0275\u0275advance(11),o.\u0275\u0275property("disabled",!e.idDocumentGED)}}function L(e,t){if(1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275elementStart(1,"div"),o.\u0275\u0275elementStart(2,"div",8),o.\u0275\u0275elementStart(3,"div",9),o.\u0275\u0275elementStart(4,"table",10),o.\u0275\u0275elementStart(5,"thead"),o.\u0275\u0275elementStart(6,"tr"),o.\u0275\u0275elementStart(7,"th",11),o.\u0275\u0275text(8),o.\u0275\u0275pipe(9,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(10,"th"),o.\u0275\u0275text(11),o.\u0275\u0275pipe(12,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(13,"th"),o.\u0275\u0275text(14),o.\u0275\u0275pipe(15,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(16,"th"),o.\u0275\u0275text(17),o.\u0275\u0275pipe(18,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(19,"th",12),o.\u0275\u0275text(20),o.\u0275\u0275pipe(21,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(22,"th",12),o.\u0275\u0275text(23),o.\u0275\u0275pipe(24,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(25,"th",12),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(26,"tbody"),o.\u0275\u0275template(27,I,22,6,"tr",13),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()),2&e){const e=o.\u0275\u0275nextContext();o.\u0275\u0275advance(8),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(9,7,"upload_document.download_template")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(12,9,"item.document.type-name")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(15,11,"document")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(18,13,"date")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(21,15,"upload_document.Upload_new_version")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1("",o.\u0275\u0275pipeBind1(24,17,"upload_document.version-history")," "),o.\u0275\u0275advance(4),o.\u0275\u0275property("ngForOf",e.settingDocumentTypes)}}function F(e,t){1&e&&(o.\u0275\u0275elementStart(0,"div"),o.\u0275\u0275elementStart(1,"div",29),o.\u0275\u0275elementStart(2,"h6",30),o.\u0275\u0275text(3),o.\u0275\u0275pipe(4,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()),2&e&&(o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(4,1,"collections.collection_document.missing_setting")))}function D(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"tr"),o.\u0275\u0275elementStart(1,"td"),o.\u0275\u0275elementStart(2,"div",22),o.\u0275\u0275text(3),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(4,"td"),o.\u0275\u0275elementStart(5,"div",22),o.\u0275\u0275text(6),o.\u0275\u0275pipe(7,"date"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(8,"td"),o.\u0275\u0275elementStart(9,"div",22),o.\u0275\u0275text(10),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(11,"td",16),o.\u0275\u0275elementStart(12,"button",40),o.\u0275\u0275listener("click",function(){const t=o.\u0275\u0275restoreView(e).$implicit;return o.\u0275\u0275nextContext(2).view(t.file,t.idDocumentGED)}),o.\u0275\u0275element(13,"i",26),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1(" ",e.name," "),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind2(7,3,e.dateCreation,"dd/MM/yyyy hh:mm a")," "),o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate1(" ",e.insertBy," ")}}const T=function(e){return{"text-end":e}};function w(e,t){if(1&e){const e=o.\u0275\u0275getCurrentView();o.\u0275\u0275elementStart(0,"div",31),o.\u0275\u0275elementStart(1,"form"),o.\u0275\u0275elementStart(2,"div",32),o.\u0275\u0275elementStart(3,"h4",33),o.\u0275\u0275text(4),o.\u0275\u0275pipe(5,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(6,"button",34),o.\u0275\u0275listener("click",function(){return(0,o.\u0275\u0275restoreView(e).close)(o.\u0275\u0275nextContext().reset())}),o.\u0275\u0275elementStart(7,"span",35),o.\u0275\u0275text(8,"\xd7"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(9,"div",36),o.\u0275\u0275elementStart(10,"div",9),o.\u0275\u0275elementStart(11,"table",10),o.\u0275\u0275elementStart(12,"thead"),o.\u0275\u0275elementStart(13,"tr"),o.\u0275\u0275elementStart(14,"th",37),o.\u0275\u0275text(15),o.\u0275\u0275pipe(16,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(17,"th",37),o.\u0275\u0275text(18),o.\u0275\u0275pipe(19,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(20,"th",37),o.\u0275\u0275text(21),o.\u0275\u0275pipe(22,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275element(23,"th",12),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(24,"tbody"),o.\u0275\u0275template(25,D,14,6,"tr",13),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(26,"div",38),o.\u0275\u0275elementStart(27,"button",39),o.\u0275\u0275listener("click",function(){return o.\u0275\u0275restoreView(e),o.\u0275\u0275nextContext().reset()}),o.\u0275\u0275text(28),o.\u0275\u0275pipe(29,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd()}if(2&e){const e=o.\u0275\u0275nextContext();o.\u0275\u0275propertyInterpolate("dir",e.getDirection()),o.\u0275\u0275property("ngClass",o.\u0275\u0275pureFunction1(21,T,"ar"===e.translate.currentLang)),o.\u0275\u0275advance(4),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(5,11,"upload_document.document-history")),o.\u0275\u0275advance(2),o.\u0275\u0275classMapInterpolate1("close ACM-modal-header-",e.translate.currentLang,""),o.\u0275\u0275advance(9),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(16,13,"upload_document.Name")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(19,15,"upload_document.Date")),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate1("",o.\u0275\u0275pipeBind1(22,17,"customer_decision.addedBy")," "),o.\u0275\u0275advance(4),o.\u0275\u0275property("ngForOf",e.historyDocuments),o.\u0275\u0275advance(3),o.\u0275\u0275textInterpolate(o.\u0275\u0275pipeBind1(29,19,"button.cancel"))}}let O=(()=>{class e{constructor(e,t,n,i,l,r,a,s,d,c){this.settingsService=e,this.datePipe=t,this.gedService=n,this.devToolsServices=i,this.sharedService=l,this.reportService=r,this.formBuilder=a,this.modalService=s,this.translate=d,this.loanMangement=c,this.loading=!0,this.productEntitys=[],this.status=!0,this.loanDocumentEntitys=[],this.loanDocumentsRemoved=[],this.listDocProd=[],this.documentListUpdated=!1,this.completeAction=new o.EventEmitter,this.requiredDocument=new o.EventEmitter,this.historyDocuments=[],this.settingDocumentTypes=[],this.checkCalledSave=!1,this.documentTypechild=new o.EventEmitter}ngOnInit(){if("GENERIC-WF"==this.category){this.item=this.sharedService.getItem();const e=new l.p;this.item.itemInstanceDTOs.forEach(e=>{e.id===this.item.actualStepInstance&&(this.currentStep=e,this.labelDocument=this.currentStep.libelle)}),this.currentStep&&(e.itemInstanceId=this.currentStep.id,e.workFlowStepId=this.currentStep.idWorkFlowStep,this.settingsService.getDocumentTypeByStep(this.currentStep.idWorkFlowStep,this.currentStep.id).subscribe(e=>{this.settingDocumentTypes=e;for(const t of this.settingDocumentTypes)if(!t.idDocumentGED&&1==t.mandatory)return void this.requiredDocument.emit(!0)}))}else this.category==s.J.SUPPLIER_CATEGORY?(this.labelDocument="generic-document.supplier",this.settingsService.getDocumentTypeByCategory(this.category,this.sharedService.getElementId().supplierId).subscribe(e=>{this.settingDocumentTypes=e;for(const t of this.settingDocumentTypes)if(!t.idDocumentGED&&1==t.mandatory)return void this.requiredDocument.emit(!0)})):this.category==s.J.THIRD_PARTY_CATEGORY?(this.labelDocument="generic-document.partner",this.settingsService.getDocumentTypeByCategory(this.category,this.sharedService.getElementId().thirdPartyId).subscribe(e=>{this.settingDocumentTypes=e;for(const t of this.settingDocumentTypes)if(!t.idDocumentGED&&1==t.mandatory)return void this.requiredDocument.emit(!0)})):this.category==s.J.CONVENTION_CATEGORY&&(this.labelDocument="generic-document.convention",this.settingsService.getDocumentTypeByCategory(this.category,this.sharedService.getElementId().conventionId).subscribe(e=>{this.settingDocumentTypes=e;for(const t of this.settingDocumentTypes)if(!t.idDocumentGED&&1==t.mandatory)return void this.requiredDocument.emit(!0)}))}initConvComponent(e){this.settingDocumentTypes=e}getDocumentType(){return this.settingDocumentTypes}createForm(){this.addDocumentForm=this.formBuilder.group({fileInput:[""]})}onFileSelected(e,t,n){this.sharedService.geTypeMimes().includes(e.target.files[0].type)?e.target.files[0].size<=this.sharedService.getMaxSizeFileUpload()?e.target.files.length>0&&(this.document={name:e.target.files[0].name,settingDocumentType:t.settingDocumentType,title:""+t.title,date:this.datePipe.transform(Date.now(),"yyyy/MM/dd"),file:e.target.files[0],mandatory:t.mandatory,documentIndex:t.documentIndex}):this.devToolsServices.openToastForMaxSizeImg(3,"alert.file_size",this.sharedService.getMaxSizeFileUpload()):this.devToolsServices.openToast(3,"alert.file_type")}view(e,t){if(""!==t&&void 0!==t)this.gedService.getDocumentType(t).subscribe(e=>{const n=e.mimeType;this.gedService.getDocument(t).subscribe(e=>{const t=new Blob([e],{type:n}),i=window.URL.createObjectURL(t);window.open(i,"_blank")})});else{const t=URL.createObjectURL(e);window.open(t,"_blank")}}remove(e,t){this.devToolsServices.openConfirmDialogWithoutRedirect("confirmation_dialog.delete").afterClosed().subscribe(e=>{e&&(this.loanDocumentEntitys[t].name="",this.loanDocumentEntitys[t].idDocumentGED=null,this.loanDocumentEntitys[t].dateCreation=null,this.loanDocumentEntitys[t].file="",this.loanDocumentsRemoved.push(this.loanDocumentEntitys[t]),this.documentListUpdated=!0)})}onUpload(e,t){this.sharedService.geTypeMimes().includes(e.target.files[0].type)?e.target.files[0].size<=this.sharedService.getMaxSizeFileUpload()?e.target.files.length>0&&(this.settingDocumentTypes[t].name=e.target.files[0].name,this.settingDocumentTypes[t].file=e.target.files[0],this.settingDocumentTypes[t].dateDebut=new Date,this.documentListUpdated=!0,s.J.CONVENTION_CATEGORY&&this.documentTypechild.emit(this.settingDocumentTypes[t])):this.devToolsServices.openToastForMaxSizeImg(3,"alert.file_size",this.sharedService.getMaxSizeFileUpload()):this.devToolsServices.openToast(3,"alert.file_type")}toggleCollapse(){this.expanded=!this.expanded}actionSave(){!1===this.documentListUpdated?this.devToolsServices.openToast(3,"alert.no_document_to_save"):this.devToolsServices.openConfirmDialogWithoutRedirect("confirmation_dialog.upload").afterClosed().subscribe(e=>{e&&this.save()})}checkRequiredDocument(){for(const e of this.settingDocumentTypes)if(e.mandatory&&!e.file&&!e.idDocumentGED)return!1;return!0}save(){var e=this;return(0,i.Z)(function*(){const t=[],n=[];if(e.sharedService.setLoader(!0),yield e.settingDocumentTypes.map((i,o)=>{const r=new l.p;let a;a=i,i.file&&""!==i.file&&(r.titre=i.libelle,r.description&&(r.description=i.description),r.auteur=s.J.AUTEUR,r.settingDocumentTypeDTO=a,r.mandatory=i.mandatory,r.name=i.file.name,r.documentSize=i.file.size,e.currentStep?r.itemInstanceId=e.currentStep.id:(r.category=e.category,e.category===s.J.SUPPLIER_CATEGORY&&(r.elementId=e.sharedService.getElementId().supplierId),e.category===s.J.CONVENTION_CATEGORY&&(r.elementId=e.sharedService.getElementId().conventionId),e.category===s.J.THIRD_PARTY_CATEGORY&&(r.elementId=e.sharedService.getElementId().thirdPartyId)),t.push(i.file),n.push(r))}),0!==e.loanDocumentsRemoved.length&&(yield e.gedService.updateAcmDocumentList(e.loanDocumentsRemoved).toPromise().then(()=>{e.devToolsServices.openToast(0,"alert.success"),e.loanDocumentsRemoved=[],e.documentListUpdated=!1})),n.length>0)yield e.gedService.saveListDocuments(t,n).toPromise().then(t=>{e.documentListUpdated=!1,t.forEach(t=>{e.devToolsServices.openToast(0,"alert.success")}),e.requiredDocument.emit(!1),e.ngOnInit()});else for(const i of e.settingDocumentTypes)if(!i.idDocumentGED&&1==i.mandatory)return void e.requiredDocument.emit(!0)})()}saveConvention(e,t){var n=this;return(0,i.Z)(function*(){const i=[],o=[];n.sharedService.setLoader(!0),yield e.map((e,n)=>{const r=new l.p;let a;a=e,e.file&&""!==e.file&&(r.titre=e.libelle,r.description&&(r.description=e.description),r.auteur=s.J.AUTEUR,r.settingDocumentTypeDTO=a,r.mandatory=e.mandatory,r.name=e.file.name,r.documentSize=e.file.size,r.category=s.J.CONVENTION_CATEGORY,r.elementId=t,i.push(e.file),o.push(r))}),0!==n.loanDocumentsRemoved.length&&(yield n.gedService.updateAcmDocumentList(n.loanDocumentsRemoved).toPromise().then(()=>{n.devToolsServices.openToast(0,"alert.success"),n.loanDocumentsRemoved=[],n.documentListUpdated=!1})),o.length>0&&(yield n.gedService.saveListDocuments(i,o).toPromise().then(e=>{n.documentListUpdated=!1,e.forEach(e=>{n.devToolsServices.openToast(0,"alert.success")}),n.ngOnInit()}))})()}downloadTemplate(e){var t=this;return(0,i.Z)(function*(){if(null!=e.reportName){const n=new d.B;n.inputFileName=e.reportName;const i=[];if(i.push(t.sharedService.getCollection()),"Clearance_Loan"==e.reportName)yield t.loanMangement.findLoanByIdIB(t.item.elementId).toPromise().then(e=>{const t=[];t.push(e[0]),n.entryList=t});else{n.entryListAcmCollections=i;let e=new a.t;e.loanId=t.sharedService.getItem().id,n.entryList=[e]}n.typeReport="GENERIC-WF"==t.category?"GENERIC WORKFLOW":"COLLECTION",t.reportService.downloadCustomReport(n).subscribe(e=>{const t=new Blob([e],{type:"application/pdf"}),n=window.URL.createObjectURL(t);window.open(n,"_blank")})}else t.devToolsServices.openToast(1,"alert.file_type")})()}openLarge(e,t){this.modalService.open(e,{size:"lg"}).result.then(e=>{}),this.category==s.J.GENERIC_WF_CATEGORY?this.gedService.findhistoryDocumentByItemStep(t.id,this.currentStep.id).subscribe(e=>{this.historyDocuments=e.filter(e=>null!==e.idDocumentGED)}):this.category===s.J.SUPPLIER_CATEGORY?this.gedService.findhistoryDocumentByCategoryElement(t.id,this.sharedService.getElementId().supplierId,this.category).subscribe(e=>{this.historyDocuments=e.filter(e=>null!==e.idDocumentGED)}):this.category===s.J.CONVENTION_CATEGORY?this.gedService.findhistoryDocumentByCategoryElement(t.id,this.sharedService.getElementId().conventionId,this.category).subscribe(e=>{this.historyDocuments=e.filter(e=>null!==e.idDocumentGED)}):this.category===s.J.THIRD_PARTY_CATEGORY&&this.gedService.findhistoryDocumentByCategoryElement(t.id,this.sharedService.getElementId().thirdPartyId,this.category).subscribe(e=>{this.historyDocuments=e.filter(e=>null!==e.idDocumentGED)})}reset(){this.historyDocuments=[],this.modalService.dismissAll()}getDirection(){return r.y.direction}}return e.\u0275fac=function(t){return new(t||e)(o.\u0275\u0275directiveInject(c.g),o.\u0275\u0275directiveInject(u.DatePipe),o.\u0275\u0275directiveInject(p.G),o.\u0275\u0275directiveInject(m.R),o.\u0275\u0275directiveInject(f.F),o.\u0275\u0275directiveInject(h.m),o.\u0275\u0275directiveInject(g.qu),o.\u0275\u0275directiveInject(v.FF),o.\u0275\u0275directiveInject(y.sK),o.\u0275\u0275directiveInject(S.q))},e.\u0275cmp=o.\u0275\u0275defineComponent({type:e,selectors:[["app-generic-workFlow-document"]],inputs:{productEntity:"productEntity",expanded:"expanded",category:"category",elementId:"elementId",originSource:"originSource"},outputs:{completeAction:"completeAction",requiredDocument:"requiredDocument",documentTypechild:"documentTypechild"},decls:14,vars:7,consts:[["id","accordionExample",1,"accordion","mb-1"],[1,"card"],["id","headingCollapseVersionHistory","data-target","#collapseVersionHistory","aria-expanded","true","aria-controls","collapseVersionHistory",1,"card-header","d-flex","justify-content-between",3,"click"],[1,"lnr-calendar-full","text-secondary","px-2"],[3,"ngClass"],["id","collapseVersionHistory","aria-labelledby","headingOne",3,"ngClass"],[4,"ngIf"],["content",""],[1,"position-relative"],[1,"table-responsive"],[1,"align-middle","mb-0","table","table-hover"],[1,"ACM-document-table-column"],[1,"text-center","ACM-document-table-column-button"],[4,"ngFor","ngForOf"],["class","mb-2 mx-2 btn-icon btn-icon-only btn-shadow btn-dashed btn btn-outline-focus","type","button",3,"click",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"text-center","px-0"],[1,"mb-2","mx-2","btn-icon","btn-icon-only","btn-shadow","btn-dashed","btn","btn-outline-focus",3,"click"],["name","plus","_nghost-gyt-c2","","ng-reflect-name","plus"],["aria-hidden","true","ng-reflect-klass","pe-7s-cloud-upload btn-icon-wrapper",1,"pe-7s-cloud-upload","btn-icon-wrapper"],["type","file","name","file",2,"display","none",3,"change"],["fileuploadMultiple",""],[1,"text-center"],["type","button",1,"mb-2","mx-2","btn-icon","btn-icon-only","btn-shadow","btn-dashed","btn","btn-outline-focus",3,"click"],[1,"pe-7s-folder","btn-icon-wrapper"],[1,"btn","btn-warning",3,"disabled","click"],[1,"pe-7s-look","btn-icon-wrapper","text-white"],[1,"pe-7s-cloud-download","btn-icon-wrapper"],[1,"text-danger"],[1,"card-body"],[1,"pt-3",2,"color","red"],[3,"dir","ngClass"],[1,"modal-header","py-2"],[1,"modal-title"],["type","button","aria-label","Close",3,"click"],["aria-hidden","true"],[1,"container","p-3"],[1,"text-center","ACM-document-table-column"],[1,"modal-footer","py-1"],[1,"mb-2","mx-2","btn","btn-outline-danger",3,"click"],[1,"btn","btn-warning",3,"click"]],template:function(e,t){1&e&&(o.\u0275\u0275elementStart(0,"div",0),o.\u0275\u0275elementStart(1,"div",1),o.\u0275\u0275elementStart(2,"div",2),o.\u0275\u0275listener("click",function(){return t.toggleCollapse()}),o.\u0275\u0275elementStart(3,"div"),o.\u0275\u0275element(4,"i",3),o.\u0275\u0275text(5),o.\u0275\u0275pipe(6,"translate"),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(7,"div"),o.\u0275\u0275element(8,"i",4),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementStart(9,"div",5),o.\u0275\u0275template(10,L,28,19,"div",6),o.\u0275\u0275template(11,F,5,3,"div",6),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275elementEnd(),o.\u0275\u0275template(12,w,30,23,"ng-template",null,7,o.\u0275\u0275templateRefExtractor)),2&e&&(o.\u0275\u0275advance(5),o.\u0275\u0275textInterpolate1(" ",o.\u0275\u0275pipeBind1(6,5,t.labelDocument)," "),o.\u0275\u0275advance(3),o.\u0275\u0275property("ngClass",!0===t.expanded?"lnr-chevron-up text-secondary":"lnr-chevron-down text-secondary"),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngClass",!0===t.expanded?"collapse show":"collapse"),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",t.settingDocumentTypes.length>0),o.\u0275\u0275advance(1),o.\u0275\u0275property("ngIf",0===t.settingDocumentTypes.length))},directives:[u.NgClass,u.NgIf,u.NgForOf,x.Lv,g._Y,g.JL,g.F],pipes:[y.X$,u.DatePipe],styles:[""]}),e})()},34214:function(e,t,n){n.d(t,{N:function(){return i}});class i{}},85922:function(e,t,n){n.d(t,{T:function(){return i}});class i{}},14459:function(e,t,n){n.d(t,{N:function(){return i}});class i{}},35338:function(e,t,n){n.d(t,{N:function(){return i}});class i{}},72084:function(e,t,n){n.d(t,{Y:function(){return i}});class i{constructor(){}}},82876:function(e,t,n){n.d(t,{f:function(){return i}});class i{constructor(){}}},95728:function(e,t,n){n.d(t,{o:function(){return i}});class i{}},98657:function(e,t,n){n.d(t,{y:function(){return i}});class i{}},74972:function(e,t,n){n.d(t,{F:function(){return i}});class i{constructor(){}}},59395:function(e,t,n){n.d(t,{q:function(){return i}});class i{}},40572:function(e,t,n){n.d(t,{G:function(){return i}});class i{constructor(){}}},97199:function(e,t,n){n.d(t,{P:function(){return i}});class i{constructor(){}}},72114:function(e,t,n){n.d(t,{B:function(){return i}});class i{constructor(){}}},39670:function(e,t,n){n.d(t,{d:function(){return i}});class i{}},21362:function(e,t,n){n.d(t,{T:function(){return i}});class i{}},37990:function(e,t,n){n.d(t,{f:function(){return i}});class i{constructor(){}}},59649:function(e,t,n){n.d(t,{n:function(){return i}});class i{}},16519:function(e,t,n){n.d(t,{X:function(){return i}});class i{}}}]);